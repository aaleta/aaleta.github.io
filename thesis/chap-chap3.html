<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 The law of mass action: animals collide | Networks, Epidemics and Collective Behavior: from Physics to Data Science</title>
  <meta name="description" content="Alberto Aleta’s dissertation" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 The law of mass action: animals collide | Networks, Epidemics and Collective Behavior: from Physics to Data Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Alberto Aleta’s dissertation" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 The law of mass action: animals collide | Networks, Epidemics and Collective Behavior: from Physics to Data Science" />
  
  <meta name="twitter:description" content="Alberto Aleta’s dissertation" />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Alberto Aleta" />


<meta name="date" content="2020-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-chap2.html"/>
<link rel="next" href="chap-chap4.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Networks, Epidemics and Collective Behavior</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="sec-chap1-intro.html"><a href="sec-chap1-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="XIX" data-path="sec-chap1-intro.html"><a href="sec-chap1-intro.html#sec:chap1_statmech"><i class="fa fa-check"></i><b>XIX</b> The birth of statistical mechanics</a>
<ul>
<li class="chapter" data-level="XIX.1" data-path="sec-chap1-intro.html"><a href="sec-chap1-intro.html#subsec:chap1_darwin"><i class="fa fa-check"></i><b>XIX.1</b> Meanwhile, in the social sciences</a></li>
</ul></li>
<li class="chapter" data-level="XX" data-path="sec-chap1-intro.html"><a href="sec-chap1-intro.html#sec:chap1_bigsci"><i class="fa fa-check"></i><b>XX</b> The century of Big Science</a>
<ul>
<li class="chapter" data-level="XX.1" data-path="sec-chap1-intro.html"><a href="sec-chap1-intro.html#subsec:chap1_more"><i class="fa fa-check"></i><b>XX.1</b> More is Different</a></li>
<li class="chapter" data-level="XX.2" data-path="sec-chap1-intro.html"><a href="sec-chap1-intro.html#subsec:chap1_lattices"><i class="fa fa-check"></i><b>XX.2</b> From lattices to networks</a></li>
</ul></li>
<li class="chapter" data-level="XXI" data-path="sec-chap1-intro.html"><a href="sec-chap1-intro.html#sec:chap1_datasci"><i class="fa fa-check"></i><b>XXI</b> The Information Age</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-chap2.html"><a href="chap-chap2.html"><i class="fa fa-check"></i><b>2</b> Statistical mechanics of networks</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap-chap2.html"><a href="chap-chap2.html#sec:chap2-graph"><i class="fa fa-check"></i><b>2.1</b> Brief introduction to graph theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-graphs-topo"><i class="fa fa-check"></i><b>2.1.1</b> Topological properties of networks</a></li>
<li class="chapter" data-level="2.1.2" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-graphs-degdist"><i class="fa fa-check"></i><b>2.1.2</b> Important degree distributions</a></li>
<li class="chapter" data-level="2.1.3" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-multilayer"><i class="fa fa-check"></i><b>2.1.3</b> Multilayer graphs</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chap-chap2.html"><a href="chap-chap2.html#sec:chap2-null"><i class="fa fa-check"></i><b>2.2</b> The problem of null models</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-null-micro"><i class="fa fa-check"></i><b>2.2.1</b> Microcanonical models</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-null-cano"><i class="fa fa-check"></i><b>2.2.2</b> Canonical models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chap-chap2.html"><a href="chap-chap2.html#sec:chap2-erg"><i class="fa fa-check"></i><b>2.3</b> Exponential random graphs</a></li>
<li class="chapter" data-level="2.4" data-path="chap-chap2.html"><a href="chap-chap2.html#sec:chap2-randomizing"><i class="fa fa-check"></i><b>2.4</b> Randomizing real networks</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-undirected"><i class="fa fa-check"></i><b>2.4.1</b> Undirected binary networks</a></li>
<li class="chapter" data-level="2.4.2" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-weighted"><i class="fa fa-check"></i><b>2.4.2</b> Undirected weighted networks</a></li>
<li class="chapter" data-level="2.4.3" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-fermbos"><i class="fa fa-check"></i><b>2.4.3</b> Fermionic and bosonic graphs</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chap-chap2.html"><a href="chap-chap2.html#sec:chap2-anomalies"><i class="fa fa-check"></i><b>2.5</b> Anomalies in transportation networks</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-anomaliesNull"><i class="fa fa-check"></i><b>2.5.1</b> Null models for undirected weighted networks</a></li>
<li class="chapter" data-level="2.5.2" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-anomaliesAIR"><i class="fa fa-check"></i><b>2.5.2</b> The worldwide air transportation network</a></li>
<li class="chapter" data-level="2.5.3" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-anomaliesOther"><i class="fa fa-check"></i><b>2.5.3</b> Other transportation networks</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="chap-chap2.html"><a href="chap-chap2.html#sec:chap2-generating"><i class="fa fa-check"></i><b>2.6</b> Generating data-driven contact networks</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-generatingTheo"><i class="fa fa-check"></i><b>2.6.1</b> Theoretical framework</a></li>
<li class="chapter" data-level="2.6.2" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-generatingData"><i class="fa fa-check"></i><b>2.6.2</b> Data description</a></li>
<li class="chapter" data-level="2.6.3" data-path="chap-chap2.html"><a href="chap-chap2.html#subsec:chap2-generatingAge"><i class="fa fa-check"></i><b>2.6.3</b> Age contact networks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-chap3.html"><a href="chap-chap3.html"><i class="fa fa-check"></i><b>3</b> The law of mass action: animals collide</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap-chap3.html"><a href="chap-chap3.html#sec:chap3-homo"><i class="fa fa-check"></i><b>3.1</b> A basic assumption: homogeneous mixing</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-homo-age"><i class="fa fa-check"></i><b>3.1.1</b> Introducing the age compartment</a></li>
<li class="chapter" data-level="3.1.2" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-homo-demo"><i class="fa fa-check"></i><b>3.1.2</b> Changing demographics</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chap-chap3.html"><a href="chap-chap3.html#sec:chap3-R0"><i class="fa fa-check"></i><b>3.2</b> The basic reproduction number</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-r0-measure"><i class="fa fa-check"></i><b>3.2.1</b> Measuring <span class="math inline">\(\mathbf{R_0}\)</span></a></li>
<li class="chapter" data-level="3.2.2" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-r0-Ref"><i class="fa fa-check"></i><b>3.2.2</b> The effective reproduction number</a></li>
<li class="chapter" data-level="3.2.3" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-r0-pnas"><i class="fa fa-check"></i><b>3.2.3</b> Measurability of the epidemic reproduction number</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chap-chap3.html"><a href="chap-chap3.html#sec:chap3-directed"><i class="fa fa-check"></i><b>3.3</b> The epidemic threshold fades out</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-directed-decade"><i class="fa fa-check"></i><b>3.3.1</b> The decade of viruses</a></li>
<li class="chapter" data-level="3.3.2" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-directed-generating"><i class="fa fa-check"></i><b>3.3.2</b> The generating function approach</a></li>
<li class="chapter" data-level="3.3.3" data-path="chap-chap3.html"><a href="chap-chap3.html#subsec:chap3-directed-multilayer"><i class="fa fa-check"></i><b>3.3.3</b> Directionality reduces the epidemic threshold in directed multiplex networks</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chap-chap3.html"><a href="chap-chap3.html#sec:chap3-age"><i class="fa fa-check"></i><b>3.4</b> Age and network structures</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-chap4.html"><a href="chap-chap4.html"><i class="fa fa-check"></i><b>4</b> Diving into the anthill</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap-chap4.html"><a href="chap-chap4.html#sec:chap4-fc"><i class="fa fa-check"></i><b>4.1</b> Online discussion boards</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-fc-description"><i class="fa fa-check"></i><b>4.1.1</b> Description of Forocoches</a></li>
<li class="chapter" data-level="4.1.2" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-fc-poisson"><i class="fa fa-check"></i><b>4.1.2</b> Introduction to inhomogeneous Poisson processes</a></li>
<li class="chapter" data-level="4.1.3" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-fc-hawkes"><i class="fa fa-check"></i><b>4.1.3</b> Fitting Hawkes processes</a></li>
<li class="chapter" data-level="4.1.4" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-fc-dynamics"><i class="fa fa-check"></i><b>4.1.4</b> The dynamics of the board</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="chap-chap4.html"><a href="chap-chap4.html#sec:chap4-pkmn"><i class="fa fa-check"></i><b>4.2</b> The dynamics of a crowd controlled game</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-pkmn-description"><i class="fa fa-check"></i><b>4.2.1</b> Description of the event</a></li>
<li class="chapter" data-level="4.2.2" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-pkmn-ledge"><i class="fa fa-check"></i><b>4.2.2</b> The ledge</a></li>
<li class="chapter" data-level="4.2.3" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-pkmn-politics"><i class="fa fa-check"></i><b>4.2.3</b> The politics of the crowd</a></li>
<li class="chapter" data-level="4.2.4" data-path="chap-chap4.html"><a href="chap-chap4.html#subsec:chap4-pkmn-conclusions"><i class="fa fa-check"></i><b>4.2.4</b> The challenges of digital crowds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-chap5.html"><a href="chap-chap5.html"><i class="fa fa-check"></i><b>5</b> Conclusions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-chap5.html"><a href="chap-chap5.html#sec:chap5-future"><i class="fa fa-check"></i><b>5.1</b> Future work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Networks, Epidemics and Collective Behavior: from Physics to Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap:chap3" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> The law of mass action: animals collide</h1>
<p>Infectious diseases have been an unpleasant companion of humankind for millions of years. Yet, crowd epidemic diseases could have only emerged within the past 11,000 years, following the rise of agriculture. The ability to maintain large and dense human populations, as well as the close contact with domestic animals, allowed the most deadly diseases to be sustained unlike when human populations were sparse <span class="citation">[<a href="references.html#ref-Wolfe2007" role="doc-biblioref">135</a>]</span>.</p>
<p>Perhaps the most-well documented epidemic outbreak in ancient times is the plague of Athens (430-427 BCE) that caused the death of Pericles and killed around 30% of Athens population <span class="citation">[<a href="references.html#ref-Hays2005" role="doc-biblioref">136</a>]</span>. The fact that some diseases were contagious was probably well-known way before that. For instance, it has been claimed that in the 14th century BCE the Hittites sent rams infected with tularemia to their enemies to weaken them <span class="citation">[<a href="references.html#ref-Barras2014" role="doc-biblioref">137</a>]</span> and there are evidences of quarantine-like isolation of leprous individuals in the Biblical book of Leviticus. Yet, it was thought that diseases were caused by <em>miasma</em> or “bad air” for over 2,000 years. It was not until the end of the XIX century that it was finally discovered that microorganisms were the cause of diseases <span class="citation">[<a href="references.html#ref-Nelson2014" role="doc-biblioref">138</a>]</span>.</p>
<p>The advent of modern epidemiology is usually attributed to John Snow who in the mid of the XIX century traced back the origin of a cholera epidemic in the city of London <span class="citation">[<a href="references.html#ref-Morabia2004" role="doc-biblioref">139</a>]</span>. However, mathematical methods were not firmly introduced until the beginning of the XX century<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>. Already in 1906 Hamer showed that “an epidemic outbreak could come to an end despite the existence of large numbers of susceptible persons in the population, merely on a <em>mechanical theory of numbers and density</em>” <span class="citation">[<a href="references.html#ref-Hamer1906" role="doc-biblioref">142</a>]</span>. Although it was thanks to the works by Ross, Kermack and McKendrick that finally a mechanistic theory of epidemics was developed as an analogy to the law of mass-action. In particular, it was McKendrick who gave the title to this chapter when he said in a lecture in 1912: “consider a type of epidemic which is spread by simple contact from human being to human being […] The rate at which this epidemic will spread depends obviously on the number of infected animals, and also on the number of animals that remain to be infected - in other words the occurence of a new infection depends on a <em>collision between an infected and uninfected animal</em>” <span class="citation">[<a href="references.html#ref-Heesterbeek2005" role="doc-biblioref">143</a>]</span>.</p>
<p>The next 50 years were mostly devoted to establishing the mathematical foundations of epidemiology. The problem was that this process was mostly done by mathematicians and statisticians, who were more interested in the theoretical implications of the models rather than in their application to data <span class="citation">[<a href="references.html#ref-Brauer2017" role="doc-biblioref">144</a>]</span>. This situation changed during the 1980s when Anderson and May, coming from a background in zoology and ecology respectively, started to collaborate with biologists and mathematicians, bridging the gap between data and theory <span class="citation">[<a href="references.html#ref-Heesterbeek2015" role="doc-biblioref">62</a>]</span>. During the 1990s graphs where introduced in epidemiological models, challenging the classical assumption of homogeneous mixing (that we will discuss in section <a href="chap-chap3.html#sec:chap3-homo">3.1</a>), and brought physicists into the field attracted by the similarity of some concepts with phase transitions in non-equilibrium systems <span class="citation">[<a href="references.html#ref-Pastor-Satorras2015Aug" role="doc-biblioref">145</a>]</span>.</p>
<p>The latest developments of epidemic modeling are based on incorporating more and more data. For instance, the Global Epidemic and Mobility (GLEaM) framework incorporates demographic data of the whole world with short-range and long-range mobility data as the basis of its epidemic model, allowing for the simulation of world-wide pandemics <span class="citation">[<a href="references.html#ref-VandenBroeck2011Dec" role="doc-biblioref">146</a>]</span>. Similarly, to properly study the spreading of Zika virus it is necessary to take into account the dynamics of mosquitoes, temperature, demographics and mobility, attached to the disease dynamics of the own virus <span class="citation">[<a href="references.html#ref-Zhang2017May" role="doc-biblioref">147</a>]</span>. Multiple sources of data are also being used in the study of vaccination, either to devise efficient administration strategies, including economic considerations <span class="citation">[<a href="references.html#ref-Heesterbeek2015Mar" role="doc-biblioref">148</a>]</span>, or to properly understand how they actually work <span class="citation">[<a href="references.html#ref-Arregui2016Feb" role="doc-biblioref">149</a>]</span>. Even more, of particular interest nowadays is analyzing the interplay between processes that have been deeply studied in complex systems such as game theory, behavior diffusion and epidemic processes.</p>
<p>Herd immunity, a term coined by Topley and Wilson in 1923 albeit with the completely opposite meaning to the current one <span class="citation">[<a href="references.html#ref-Topley1923May" role="doc-biblioref">150</a>]</span>, refers to the fact that it is possible to have a population where diseases cannot spread even if only a fraction of the individuals are immune to it. Firstly calculated theoretically in 1970 by Smith <span class="citation">[<a href="references.html#ref-Smith1970Nov" role="doc-biblioref">151</a>]</span>, it has been the subject of great interest as it allows to completely immunize a population even if there are members who cannot be administered a vaccine due to their medical conditions <span class="citation">[<a href="references.html#ref-Fine2011Apr" role="doc-biblioref">152</a>]</span>. Unfortunately, the great successes achieved by vaccination are now endangered by people who refuse to vaccinate their children, which also affects those kids who cannot be vaccinated but should have been protected by herd immunity <span class="citation">[<a href="references.html#ref-Larson2011Aug" role="doc-biblioref">153</a>]</span>.</p>
<p>For instance, measles requires 95% of the population to be vaccinated for herd immunity to work. This was achieved in the U.S. by the end of the past century, being declared measles free in 2000. Similarly, the UK was declared measles free in 2017. Yet, the World Health Organization (WHO) removed this status from the UK in August 2019 <span class="citation">[<a href="references.html#ref-measlesUK" role="doc-biblioref">154</a>]</span>, and the U.S. is facing a similar fate as so far in 2019 they have reported the greatest number of cases since 1992 <span class="citation">[<a href="references.html#ref-measlesUS" role="doc-biblioref">155</a>]</span>. Both phenomena have been attributed to anti-vaccine groups, whose behavior can be studied from the point of view of game theory. But there are more ingredients into play. In particular, if the risk of infection is regarded low, maybe thanks to herd immunity, the motivation to become vaccinated can decrease. This behavior can then be spread among adults, a process that will be clearly coupled with the disease dynamics. Thus, a holistic view of the whole problem is needed, something that can only be done under the lenses of complex systems <span class="citation">[<a href="references.html#ref-Wang2016Dec" role="doc-biblioref">156</a>]</span>.</p>
<p>In this context, rather than extending the mathematical formalism that is already well established, we pushed forward our knowledge about disease dynamics by adding data and revisiting some of the assumptions classically made either for simplicity or lack of information. For this reason, rather than giving a whole mathematical introduction and then visiting each contribution, we will organize them in a way that roughly follows the historical development of mathematical epidemiology, explaining in each section the basic ideas and then showing how we challenged those assumptions.</p>
<p>We will begin in section <a href="chap-chap3.html#sec:chap3-homo">3.1</a> with the most basic approach to disease dynamics. That is, humans are gathered in closed populations in which every individual can contact every other, very much like particles colliding in a box. This simple premise, known as <em>homogeneous mixing</em>, can be slightly improved by considering individuals to be part of smaller groups, with correspondingly different patterns of interaction. This is the classical approach to introduce the age structure of the population, for which experimental data exist. We will, however, go one step further and analyze the problem of projecting this data into the future, taking into account the demographic evolution of society. This part of the thesis will be thus based on the publication:</p>
<blockquote>
<p>Arregui, S., Aleta, A., Sanz, J. and Moreno, Y., <a href="https://doi.org/10.1371/journal.pcbi.1006638">Projecting social contact matrices to different demographic structures</a>, PLoS Comput. Biol. 14:e1006638, 2018</p>
</blockquote>
<p>Our next step will be to introduce, in section <a href="chap-chap3.html#sec:chap3-R0">3.2</a>, one of the cornerstone quantities of modern epidemiology, the basic reproduction number, <span class="math inline">\(R_0\)</span>. We will revisit its original definition and challenge it using data-driven population models, demonstrating that some of the assumptions that have been made since its conception are not entirely correct. This corresponds to the work:</p>
<blockquote>
<p>Liu, Q.-H., Ajelli, M., Aleta, A., Merler, S., Moreno, Y. and Vespignani, A., <a href="https://doi.org/10.1073/pnas.1811115115">Measurability of the epidemic reproduction number in data-driven contact networks</a>, Proc. Natl. Acad. Sci. U.S.A., 115:12680-12685, 2018</p>
</blockquote>
<p>Then, in section <a href="chap-chap3.html#sec:chap3-directed">3.3</a> we will finally introduce networks into the picture. We will show some of the counter-intuitive consequences of this and, again, challenge some of the most basic assumptions. In particular, disease dynamics are often implemented on single layer undirected networks, but we will show that directionality can play a crucial role on the dynamics, with particular emphasis on multilayer networks. We will follow the article</p>
<blockquote>
<p>Wang, X., Aleta, A., Lu, D., Moreno, Y., <a href="https://doi.org/10.1088/1367-2630/ab3dd0">Directionality reduces the impact of epidemics in multilayer networks</a>, New. J. Phys., 21:093026, 2019</p>
</blockquote>
<p>of which I am first co-author.</p>
<p>We will finish this chapter in section <a href="chap-chap3.html#sec:chap3-age">3.4</a> analyzing the age-contact networks that we generated in section <a href="chap-chap2.html#sec:chap2-generating">2.6</a>, chapter <a href="chap-chap2.html#chap:chap2">2</a>. The objective of this part will be to show the different approaches than can be followed depending on the available data and their impact in the outcome of the dynamics. This will be based on the work</p>
<blockquote>
<p>Aleta, A., Ferraz de Arruda, G. and Moreno, Y., <a href="https://doi.org/10.1371/journal.pcbi.1008035">Data-driven contact structures: From homogeneous mixing to multilayer networks</a>, PLoS Comput. Biol. 16(7):e1008035, 2020</p>
</blockquote>
<div id="sec:chap3-homo" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> A basic assumption: homogeneous mixing</h2>
<p>The starting point of this discussion is going to be precisely the own introduction of the paper by Kermack and McKendrick published in 1927 that is regarded as the starting point of modern epidemiological models <span class="citation">[<a href="references.html#ref-Kermack1927" role="doc-biblioref">157</a>]</span>. Even if over 90 years have passed, any text written today about the subject would start roughly in the same way:</p>
<p>“The problem may be summarised as follows: One (or more) infected person is introduced into a community of individuals, more or less susceptible to the disease in question. The disease spreads from the affected to the unaffected by contact infection. Each infected person runs through the course of his sickness, and finally is removed from the number of those who are sick, by recovery or by death. The chances of recovery or death vary from day to day during the course of his illness. The chances that the affected may convey infection to the unaffected are likewise dependent upon the stage of the sickness. As the epidemic spreads, the number of unaffected members of the community becomes reduced. Since the course of an epidemic is short compared with the life of an individual, the population may be considered as remaining constant, except in as far as it is modified by deaths due to the epidemic disease itself. In the course of time the epidemic may come to an end. […] [This] discussion will be limited to the case in which all members of the community are initially equally susceptible to the disease, and it will be further assumed that complete immunity is conferred by a single infection.”</p>
<p>For the shake of clarity we can summarize some of the implicit assumptions in the previous paragraph, plus some more that were introduced in other parts of the paper, as <span class="citation">[<a href="references.html#ref-diekmann1995" role="doc-biblioref">158</a>]</span>:</p>
<ol style="list-style-type: decimal">
<li>The disease is directly transmitted from host to host.</li>
<li>The disease ends in either complete immunity or death.</li>
<li>Contacts are according to the law of mass-action.</li>
<li>Individuals are only distinguishable by their health status.</li>
<li>The population is closed.</li>
<li>The population is large enough to be described with a deterministic approach.</li>
</ol>
<p>In this section we will explore the effect of relaxing assumptions 3 and 4. Note that these two assumptions can be regarded as an approximation when no sufficient data about the whereabouts of the population are known. Now, however, we have much more data available than they did and thus in section <a href="chap-chap3.html#sec:chap3-R0">3.2</a> we will be able to completely remove assumption 4. Similarly, in sections <a href="chap-chap3.html#sec:chap3-directed">3.3</a> and <a href="chap-chap3.html#sec:chap3-age">3.4</a> we will suppress assumptions 2 and 3. Besides, except for this introduction, throughout the chapter we will disregard assumption 6, but we will always respect the 1st and 5th ones.</p>
<p>With modern terminology, models in which individuals are only distinguishable by their health status are known as <em>compartmental models</em>. In these models, it is supposed that each individual belongs to one and only one <em>compartment</em> (class, in Kermack and McKendrick terms). Compartments are a tool to encapsulate the complexity of infections in a simple way. Hence, an individual that is completely free from the disease but can be infected is said to be in the <em>susceptible</em> state (<span class="math inline">\(S\)</span>), one that can spread the disease is said to be <em>infected</em> (<span class="math inline">\(I\)</span>) and one that can neither be infected nor infect is said to be <em>removed</em> (<span class="math inline">\(R\)</span>) either because is immune or dead. This classification is known as the <span class="math inline">\(SIR\)</span> model. This framework, however, is quite flexible and it is possible to incorporate as many compartments as needed, depending on the disease under study, reaching hundreds of compartments in the most sophisticated models <span class="citation">[<a href="references.html#ref-Arregui2018Apr" role="doc-biblioref">159</a>]</span>. In particular, in section <a href="chap-chap3.html#subsec:chap3-homo-demo">3.1.2</a>, we will introduce the <em>exposed</em> (<span class="math inline">\(E\)</span>) state to classify individuals that have been infected but are not yet infectious.</p>
<p>The six assumptions, after some algebra, lead to the original equation proposed by Kermack and McKendrick (albeit with slightly updated notation),</p>
<p><span class="math display" id="eq:chap3-homo-original">\[\begin{equation}
\frac{\text{d}S(t)}{\text{d}t} = S(t) \int_0^\infty A(\tau) \frac{\text{d}S(t-\tau)}{\text{d}t} \text{d}\tau\,,
\tag{3.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(S(t)\)</span> denotes the number of individuals in the susceptible compartment - henceforth number of susceptibles - at time <span class="math inline">\(t\)</span> and <span class="math inline">\(A(\tau)\)</span> is the expected infectivity of an individual that became infected <span class="math inline">\(\tau\)</span> units of time ago <span class="citation">[<a href="references.html#ref-Kermack1927" role="doc-biblioref">157</a>], [<a href="references.html#ref-diekmann1995" role="doc-biblioref">158</a>]</span>.</p>
<p>To obtain <span class="math inline">\(A(\tau)\)</span>, we define <span class="math inline">\(\phi(\tau)\)</span> as the rate of infectivity of an individual that has been infected for a time <span class="math inline">\(\tau\)</span>. Similarly, we define <span class="math inline">\(\psi(\tau)\)</span> as the rate of removal, either by immunization or death. Let us denote by <span class="math inline">\(v(t,\tau)\)</span> the number of individuals that are infected at time <span class="math inline">\(t\)</span> and have been infected for a period of length <span class="math inline">\(\tau\)</span>. If we divide time into separate intervals <span class="math inline">\(\Delta t\)</span>, such that the infection takes places only at the instant of passing from one interval to the next, the following relation holds:</p>
<p><span class="math display" id="eq:chap3-homo-removal">\[\begin{equation}
\begin{split}
v(t,\tau) &amp; = v(t-\Delta t,\tau-\Delta t)(1-\psi(\tau-\Delta t)) \\
		&amp; = v(t-2\Delta t,\tau-2\Delta t)(1-\psi(\tau-\Delta t))(1-\psi(\tau-2\Delta t)) \\
		&amp; = v(t-\tau,0) B(\tau)\,,
\end{split}
\tag{3.2}
\end{equation}\]</span></p>
<p>so that, if <span class="math inline">\(\Delta t\)</span> is small enough,</p>
<p><span class="math display" id="eq:chap3-homo-B">\[\begin{equation}
\begin{split}
B(\tau) &amp; = (1-\psi(\tau-\Delta t))(1-\psi(\tau-2\Delta t))\ldots(1-\psi(0)) \\
		&amp; \approx e^{-\psi(\tau-\Delta t)} e^{-\psi(\tau-2\Delta t)} \ldots e^{-\psi(0)} \\
		&amp; \approx e^{-\int_0^\tau \psi(a) \text{d}a}\,.
\end{split}
\tag{3.3}
\end{equation}\]</span></p>
<p>Hence,</p>
<p><span class="math display" id="eq:chap3-homo-A">\[\begin{equation}
A(\tau) = \phi(\tau) B(\tau) = \phi(\tau) e^{-\int_0^\tau \psi(a) \text{d} a}\,,
\tag{3.4}
\end{equation}\]</span></p>
<p>which defines the original shape of the Kermack and McKendrick model.</p>
<p>However, in the literature it is common to present as the Kermack and McKendrick model the special case they analyze in their paper in which both the infectivity and removal rates are constant. Indeed, if we set <span class="math inline">\(\phi(\tau) = \beta\)</span> and <span class="math inline">\(\psi(\tau)=\mu\)</span>,</p>
<p><span class="math display" id="eq:chap3-homo-A2">\[\begin{equation}
A(\tau) = \beta e^{-\int_0^\tau \mu \text{d}{a}} = \beta e^{-\mu\tau}\,,
\tag{3.5}
\end{equation}\]</span></p>
<p>and defining the number of infected individuals at time <span class="math inline">\(t\)</span> as</p>
<p><span class="math display" id="eq:chap3-homo-It">\[\begin{equation}
I(t) \equiv -\frac{1}{\beta} \int_0^\infty A(\tau) \frac{\text{d}S(t-\tau)}{\text{d}t} \text{d}\tau \,,
\tag{3.6}
\end{equation}\]</span></p>
<p>equation <a href="chap-chap3.html#eq:chap3-homo-original">(3.1)</a> reads</p>
<p><span class="math display" id="eq:chap3-homo-St">\[\begin{equation}
\frac{\text{d}S(t)}{\text{d}t} = - \beta I(t) S(t)\,.
\tag{3.7}
\end{equation}\]</span></p>
<p>If we now derive expression <a href="chap-chap3.html#eq:chap3-homo-It">(3.6)</a>, using Leibniz’s rule,</p>
<p><span class="math display" id="eq:chap3-homo-dIt">\[\begin{equation}
\begin{split}
\frac{\text{d}I(t)}{\text{d}t} &amp; = -\frac{\text{d}S(t)}{\text{d}t} - \int_{-\infty}^t \frac{\partial}{\partial t} e^{-\mu(t-\tau)} \frac{\text{d}S(\tau)}{\text{d}t} \text{d}\tau \\
			&amp; = - \frac{\text{d}S(t)}{\text{d}t} + \mu \int_0^\infty e^{-\mu \tau} \frac{\text{d}S(t-\tau)}{\text{d}t} \text{d} \tau \\
			&amp; = \beta I(t) S(t) - \mu I(t)\,,
\end{split}
\tag{3.8}
\end{equation}\]</span></p>
<p>together with the fact that the population, <span class="math inline">\(N\)</span>, is closed, <span class="math inline">\(S(t) + I(t) + R(t) = N\)</span>, we obtain the system of equations</p>
<p><span class="math display" id="eq:chap3-homo-homo">\[\begin{equation}
\left\{\begin{array}{l}
\frac{\text{d}S(t)}{\text{d}t}  = - \beta I(t) S(t) \\
\frac{\text{d}I(t)}{\text{d}t}  = \beta I(t) S(t) - \mu I(t) \\
\frac{\text{d}R(t)}{\text{d}t}  = \mu I(t)
\end{array}\right.
\tag{3.9}
\end{equation}\]</span></p>
<p>which is the model that is usually introduced as the Kermack-McKendrick, even though we have seen that their original contribution was much more general <span class="citation">[<a href="references.html#ref-murray2002" role="doc-biblioref">160</a>]</span>.</p>
<p>Equation <a href="chap-chap3.html#eq:chap3-homo-homo">(3.9)</a> is also often used to introduce epidemic models in the literature as it constitutes one of the most basic models. As we are considering that every individual can contact every other this model is also known as the <em>homogeneous mixing</em> model <span class="citation">[<a href="references.html#ref-Pastor-Satorras2015Aug" role="doc-biblioref">145</a>], [<a href="references.html#ref-Boccaletti2006Feb" role="doc-biblioref">161</a>]</span>. However, it should be noted that sometimes a slightly different version of this set of equations is presented. Indeed, if we define the fraction of susceptible individuals in the population as <span class="math inline">\(s(t)\equiv S(t)/N\)</span>, and similarly with the others, note that the expression for the evolution of infected individuals is</p>
<p><span class="math display" id="eq:chap3-homo-i1">\[\begin{equation}
\frac{\text{d}i(t)}{\text{d}t} = \beta N i(t) s(t) - \mu i(t)\,.
\tag{3.10}
\end{equation}\]</span></p>
<p>Hence, the larger the population, the faster the spreading. This is known as the <em>density dependent</em> approach. However, we can formulate a very similar model in which we define the infectivity rate as <span class="math inline">\(\phi(\tau) = \beta/N\)</span>, so that</p>
<p><span class="math display" id="eq:chap3-homo-i2">\[\begin{equation}
\frac{\text{d}i(t)}{\text{d}t} = \beta i(t) s(t) - \mu i(t)\,
\tag{3.11}
\end{equation}\]</span></p>
<p>is independent of <span class="math inline">\(N\)</span>. This latter approach is called <em>frequency dependent</em> and is probably the most common one in the literature of epidemic processes on networks. Both approaches are valid and depend on the specific disease that is being modeled, see <span class="citation">[<a href="references.html#ref-McCallum2001Jun" role="doc-biblioref">162</a>]</span> for a deeper discussion of this matter.</p>
<p>Despite the simplicity of this model, it provides two very powerful insights about disease dynamics. The first one is related to the reasons that account for the termination of an epidemic. Until the publication of this model, the most accepted explanations in medical circles were that an epidemic stopped either because all susceptible individuals had been removed or because during the course of the epidemic the virulence of the organism causing the disease decreased gradually <span class="citation">[<a href="references.html#ref-Anderson1991Mar" role="doc-biblioref">163</a>]</span>. Yet, this model shows that with a fixed virulence (<span class="math inline">\(\beta\)</span>) it is possible to reach states in which the epidemic fades out even if there are still susceptible individuals. To demonstrate this, although some approximations can be done to show this behavior (there is no closed form solution of the model), for our purposes it suffices to show a numerical solution, figure <a href="chap-chap3.html#fig:chap3-homo-homo">3.1</a>A.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-homo-homo"></span>
<img src="images/Fig_chap3_homo_homo.png" alt="Basic results of the homogeneous mixing model. In panel A the evolution of the set of equations (3.9) as a function of time with \(\beta=0.16\) and \(\mu=0.10\) is shown. It is possible to reach a disease free state with a fraction of susceptible individuals larger than 0. In panel B the total fraction of recovered individuals in equilibrium conditions as a function of \(\beta/\mu\) is shown. For simplicity the frequency dependent approach has been used so that the threshold is 1." width="678" />
<p class="caption">
Figure 3.1: <strong>Basic results of the homogeneous mixing model.</strong> In panel A the evolution of the set of equations <a href="chap-chap3.html#eq:chap3-homo-homo">(3.9)</a> as a function of time with <span class="math inline">\(\beta=0.16\)</span> and <span class="math inline">\(\mu=0.10\)</span> is shown. It is possible to reach a disease free state with a fraction of susceptible individuals larger than 0. In panel B the total fraction of recovered individuals in equilibrium conditions as a function of <span class="math inline">\(\beta/\mu\)</span> is shown. For simplicity the frequency dependent approach has been used so that the threshold is 1.
</p>
</div>

<p>At this point a clarification might be in order. During the introduction we said that Hamer had already showed in 1906 that it was possible for an epidemic to end despite the existence of large number of susceptible persons in the population. However, the difference resides in that Hamer proposal was based on data about measles, while this model is formulated without any specific disease in mind. Indeed, although clearly influenced by Hamer’s and Ross’ works, one of the great achievements of Kermack and McKendrick was to establish a formulation based only on mechanistic principles, regardless of the specific properties of the disease. Nonetheless, the most important result of this model has not been discussed yet, the <em>epidemic threshold</em>.</p>
<p>Suppose that in a completely susceptible population we introduce a tiny amount of infected individuals so that <span class="math inline">\(s(t=0) \equiv s_0 = 1 - \epsilon\)</span> and <span class="math inline">\(i(t=0) \equiv i_0 = \epsilon\)</span> with <span class="math inline">\(\epsilon\rightarrow 0\)</span>. If we linearize equation <a href="chap-chap3.html#eq:chap3-homo-i1">(3.10)</a> around this point, we have</p>
<p><span class="math display" id="eq:chap3-homo-i1lin">\[\begin{equation}
\frac{\text{d}i(t)}{\text{d}t} \approx \beta N i_0 s_0 - \mu i_0\,,
\tag{3.12}
\end{equation}\]</span></p>
<p>which only grows if <span class="math inline">\(\beta N - \mu &gt; 0\)</span>. Hence, there exists a minimum susceptible population at the initial state below which an epidemic cannot take place, the epidemic threshold:</p>
<p><span class="math display" id="eq:chap3-homo-th">\[\begin{equation}
N_c &gt; \frac{\mu}{\beta}\,.
\tag{3.13}
\end{equation}\]</span></p>
<p>Note that the formulation of this threshold can vary slightly according to the characteristics of the model. For instance, in the frequency dependent approach, equation <a href="chap-chap3.html#eq:chap3-homo-i2">(3.11)</a>, the epidemic threshold is defined by</p>
<p><span class="math display" id="eq:chap3-homo-th2">\[\begin{equation}
\frac{\beta}{\mu} &gt; 1\,,
\tag{3.14}
\end{equation}\]</span></p>
<p>which is independent of <span class="math inline">\(N\)</span>. The existence of this threshold is numerically demonstrated in figure <a href="chap-chap3.html#fig:chap3-homo-homo">3.1</a>B, where the final fraction of recovered individuals as a function of the ratio <span class="math inline">\(\beta/\mu\)</span> is shown. Regardless of the specific shape of the condition, the message is that it is possible to explain why an epidemic might not spread in a population of fully susceptible individuals. Moreover, it also provides a mechanism to fight diseases before they spread. Indeed, in equation <a href="chap-chap3.html#eq:chap3-homo-th">(3.13)</a> we have simply considered that <span class="math inline">\(S_0 = N\)</span>, but if we were able to immunize a fraction of the population so that <span class="math inline">\(S_0 &lt; \mu/\beta\)</span> then the epidemic could not take place. In other words, we would have conferred the population the herd immunity discussed in the beginning of the chapter.</p>
<div id="subsec:chap3-homo-age" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Introducing the age compartment</h3>
<p>Since the establishment of epidemiology as a science, a lot of attention has been devoted to the study of measles as its recurring patterns puzzled physicians and mathematicians alike. The distinguishing characteristic of measles epidemics is that they had a very regular temporal pattern with periodic outbreaks of the disease, as shown in figure <a href="chap-chap3.html#fig:chap3-homo-measles">3.2</a>. As this disease affects specially the children and also conveys permanent immunity to those who have suffered it, analyzing the time evolution over large time-scales to obtain the patterns required the inclusion of age in the models. Nevertheless, with the basic model that we have analyzed we can already propose a plausible explanation for this behavior. Indeed, we know that if the amount of susceptibles in the population is below a given threshold, the epidemic cannot take place. Thus, it seems reasonable to think that once the epidemic fades-out, there is a period in which there are not enough susceptibles for it to appear again. Yet, when new children are born, the amount of susceptibles will increase, possibly going above the threshold and therefore allowing a new outbreak.</p>
<p>A similar explanation was already proposed by Soper in 1929 <span class="citation">[<a href="references.html#ref-Soper1929" role="doc-biblioref">164</a>]</span>, although it only matched the observations qualitatively, not quantitatively. It was Barlett who, in 1957, finally provided a quantitative explanation of the phenomenon <span class="citation">[<a href="references.html#ref-Bartlett1957" role="doc-biblioref">165</a>]</span>. Besides the details that we have already discussed, in his proposal he added a new factor that we have not mentioned yet. He proposed that the problem of previous models was that they were deterministic, an approximation that is only valid in very large populations. However, it was observed that the periodicity of measles not only depended on the size of the city, but it was specially so in small towns. In physical terms, we would say that there were finite size effects, tearing down assumption 6 (see section <a href="chap-chap3.html#sec:chap3-homo">3.1</a>). Thus, he proposed to use a stochastic model for which he could not obtain a closed form solution, so he had to resort to an “electronic computer”. Nowadays the use of stochastic computational simulations are much more common than the deterministic approach. The reasons why this approach is more favorable are out of the scope of this thesis (see, for instance <span class="citation">[<a href="references.html#ref-Foppa2016Oct" role="doc-biblioref">140</a>], [<a href="references.html#ref-Britton2010May" role="doc-biblioref">166</a>]–[<a href="references.html#ref-bailey1975" role="doc-biblioref">168</a>]</span> for a discussion) but we will leverage this opportunity to say that in the following sections we will mostly work with stochastic simulations, rather than deterministic approaches. Before concluding the discussion about Barlett’s paper, we find worth highlighting that it was presented during a meeting of the Royal Statistical Society, in 1956, after which a discussion followed. In said discussion, Norman T. J. Bailey said <em>“One of the signs of the times is the use of an electronic computer to handle the Monte Carlo experiments. Provided they are not made an excuse for avoiding difficult mathematics, I think there is a great scope for such computers in biometrical work”</em>. And indeed there was, as 25 years later Mr. Bailey was appointed Professor of Medical Informatics <span class="citation">[<a href="references.html#ref-Bailey1986" role="doc-biblioref">169</a>]</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-homo-measles"></span>
<img src="images/Fig_chap3_homo_measles.png" alt="Measles epidemics in New York from 1906 to 1948. This figure represents the number of reported cases of measles in the city of New York from 1906 to 1948 with a biweekly resolution. There are some gaps due to missing reports. Data obtained from [170]." width="677" />
<p class="caption">
Figure 3.2: <strong>Measles epidemics in New York from 1906 to 1948.</strong> This figure represents the number of reported cases of measles in the city of New York from 1906 to 1948 with a biweekly resolution. There are some gaps due to missing reports. Data obtained from <span class="citation">[<a href="references.html#ref-Dalziel2016Feb" role="doc-biblioref">170</a>]</span>.
</p>
</div>

<p>Returning to our discussion, it is not surprising, then, that McKendrick already introduced age in his models in 1926 <span class="citation">[<a href="references.html#ref-McKendrick1926" role="doc-biblioref">171</a>]</span>, one year before the publication of the full model that we have already explored. However, to introduce age we will use a slightly more modern formulation that will simplify the analysis. In particular, we need to revisit assumption 4, i.e., individuals are only distinguishable by their health status.</p>
<p>Let us state that individuals can now be identified both by their health status and their age. Hence, we have to add more compartments to the model, one for each age group and health status combination. In other words, rather than having three compartments, <span class="math inline">\(S,I,R\)</span>, we now have 3 times the number of age brackets considered, i.e. <span class="math inline">\(S_a, I_a, R_a\)</span> being <span class="math inline">\(a\)</span> the age bracket the individuals belong to (see <a href="chap-chap2.html#sec:chap2-generating">2.6</a> for the definition of age bracket). Moreover, we will suppose that the disease dynamics is much faster than the demographic evolution of the population. The only thing left is to decide how to go from one compartment to another:</p>
<ul>
<li>For the rate of infectivity, we will define an auxiliary expression that will facilitate the discussion. By inspection of equation <a href="chap-chap3.html#eq:chap3-homo-homo">(3.9)</a>, we can define the <em>force of infection</em> <span class="citation">[<a href="references.html#ref-Anderson1991Mar" role="doc-biblioref">163</a>]</span> as</li>
</ul>
<p><span class="math display" id="eq:chap3-homo-force">\[\begin{equation}
\lambda(t) \equiv \phi(\tau) I(t) = \beta I(t)\,,
\tag{3.15}
\end{equation}\]</span></p>
<p>which does not depend on any characteristic of the individual. Hence, we can simply incorporate age by modifying the force of infection so that</p>
<p><span class="math display" id="eq:chap3-homo-force2">\[\begin{equation}
\lambda(t,a) = \sum_{a&#39;} \phi(\tau,a,a&#39;) I_{a&#39;}(t)\,.
\tag{3.16}
\end{equation}\]</span></p>
<p>This way, both the age of the individual that is getting infected (<span class="math inline">\(a\)</span>) and the age of all other individuals (<span class="math inline">\(\sum_{a&#39;}\)</span>) are taken into account. Furthermore, we can separate <span class="math inline">\(\phi(\tau,a,a&#39;)\)</span> into two components: one accounting for the rate of contacts between individuals of age <span class="math inline">\(a\)</span> and <span class="math inline">\(a&#39;\)</span> and another one accounting for the likelihood that such contacts lead to an infection. Hence,</p>
<p><span class="math display" id="eq:chap3-homo-phiage">\[\begin{equation}
\phi(\tau,a,a&#39;) \equiv C(a,a&#39;) \beta(a,a&#39;)\,.
\tag{3.17}
\end{equation}\]</span></p>
<p>Recalling section <a href="chap-chap2.html#sec:chap2-generating">2.6</a>, the term <span class="math inline">\(C(a,a&#39;)\)</span> can be obtained from the contact surveys that we have already studied. On the other hand, we will suppose that the likelihood of infection is independent of the age so that <span class="math inline">\(\beta(a,a&#39;) = \beta\)</span>.</p>
<ul>
<li>For the rate of recovery, we will assume that it is independent of the age of the individual, i.e. <span class="math inline">\(\mu(a) = \mu\)</span>.</li>
</ul>
<p>Under these assumptions, the homogeneous mixing model with age dependent contacts reads
<span class="math display" id="eq:chap3-homo-homoage">\[\begin{equation}
\left\{\begin{array}{l}
\frac{\text{d}S_a(t)}{\text{d}t}  = - \sum_{a&#39;}\beta C(a,a&#39;) I_{a&#39;}(t) S_a(t) \\
\frac{\text{d}I_a(t)}{\text{d}t}  = \sum_{a&#39;}\beta C(a,a&#39;) I_{a&#39;}(t) S_a(t) - \mu I_a(t) \\
\frac{\text{d}R_a(t)}{\text{d}t}  = \mu I_a(t)
\end{array}\right.
\tag{3.18}
\end{equation}\]</span></p>
<p>Despite its simplicity, this model is still widely used today, specially in the context of metapopulations<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> <span class="citation">[<a href="references.html#ref-DeLuca2018Dec" role="doc-biblioref">132</a>]</span>. Even more, as in all compartmental models, it is straightforward to extend it to include more complex dynamics. For instance, we can add the exposed state so that individuals that get infected remain in a latent state for a certain amount of time before showing symptoms and being able to infect others. This model, known as the <em>SEIR</em> model, can be used to describe influenza dynamics <span class="citation">[<a href="references.html#ref-keeling2007" role="doc-biblioref">173</a>]</span></p>
<p><span class="math display" id="eq:chap3-homo-seir">\[\begin{equation}
\left\{\begin{array}{l}
\frac{\text{d}S_a(t)}{\text{d}t}  = - \sum_{a&#39;}\beta C(a,a&#39;) I_{a&#39;}(t) S_a(t) \\
\frac{\text{d}E_a(t)}{\text{d}t}  = \sum_{a&#39;}\beta C(a,a&#39;) I_{a&#39;}(t) S_a(t) - \sigma E_a(t)\\
\frac{\text{d}I_a(t)}{\text{d}t}  = \sigma E_a(t) - \mu I_a(t) \\
\frac{\text{d}R_a(t)}{\text{d}t}  = \mu I_a(t)
\end{array}\right. \,.
\tag{3.19}
\end{equation}\]</span></p>
<p>The new parameter, <span class="math inline">\(\sigma\)</span>, accounts for the rate at which an individual from the latent state goes to the infectious state, in a similar fashion as <span class="math inline">\(\mu\)</span> does for the transition from <span class="math inline">\(I\)</span> to <span class="math inline">\(R\)</span>. This model will be the focus of the last part of this section.</p>
</div>
<div id="subsec:chap3-homo-demo" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Changing demographics</h3>
<blockquote>
<p>I call myself a Social Atom - a small speck on the surface of society.<br />
<em>“Memoirs of a social atom”</em>, William E. Adams</p>
</blockquote>
<p>As we discussed earlier, for a long period of time the developments in mathematical epidemiology were disconnected from data, at least until Anderson and May arrived to the field in the late 1980s. It is not so surprising, then, that even though age was incorporated into models since the beginning of the discipline, we had to wait until the late 1990s to get experimental data of age mixing patterns.</p>
<p>The first attempt to quantify the mixing behavior responsible for infections transmitted by respiratory droplets or close contact (which are the ones best suited to be studied with homogeneous mixing models) was the pioneering work by Edmunds et al. in 1997 <span class="citation">[<a href="references.html#ref-Edmunds1997" role="doc-biblioref">174</a>]</span>. Their results, however, can hardly be extrapolated as they only analyzed a population consisting of 62 individuals coming from two British universities. The first large-scale experiment to measure these patterns was conducted by Mossong et al. in 2008 <span class="citation">[<a href="references.html#ref-Mossong2008Mar" role="doc-biblioref">131</a>]</span>. In their study, they measured the age-dependent contact rates in eight European countries (Belgium, Finland, Germany, Great Britain, Italy, Luxembourg, Netherlands and Poland), as part of the European project Polymod, using contact diaries. In the next years other authors followed the route opened by Mossong et al. and measured the age-dependent social contacts of countries such as China <span class="citation">[<a href="references.html#ref-Read2014Jun" role="doc-biblioref">175</a>]</span>,
France <span class="citation">[<a href="references.html#ref-Beraud2015Jul" role="doc-biblioref">176</a>]</span>, Japan <span class="citation">[<a href="references.html#ref-Ibuka2016Feb" role="doc-biblioref">177</a>]</span>, Kenya <span class="citation">[<a href="references.html#ref-Kiti2014Aug" role="doc-biblioref">178</a>]</span>, Russia <span class="citation">[<a href="references.html#ref-Ajelli2017Apr" role="doc-biblioref">179</a>]</span>, Uganda <span class="citation">[<a href="references.html#ref-deWaroux2018Dec" role="doc-biblioref">180</a>]</span> or Zimbabwe <span class="citation">[<a href="references.html#ref-Melegaro2017Jan" role="doc-biblioref">181</a>]</span>, as well as the Special Administrative Region of Hong Kong <span class="citation">[<a href="references.html#ref-Leung2017Aug" role="doc-biblioref">182</a>]</span>, greatly expanding the available empirical data.</p>
<p>These experiments provide us with the key ingredient required for the introduction of age compartments into the models, the age contact matrix, <span class="math inline">\(C\)</span>. There are, however, a couple of ways of defining this matrix that are equivalent under certain transformations. We define the matrix in <em>extensive scale</em>, <span class="math inline">\(C\)</span>, as the one in which each element <span class="math inline">\(C_{i,j}\)</span> contains the total number of contacts between two age groups <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. It is trivial to see that given this definition there must be reciprocity in the system, i.e.,</p>
<p><span class="math display" id="eq:chap3-homo-reciC">\[\begin{equation}
C_{i,j} = C_{j,i}\,.
\tag{3.20}
\end{equation}\]</span></p>
<p>A similar definition can be obtained if instead of accounting for all the contacts between two groups we want to capture the average number of contacts that a single individual of group <span class="math inline">\(i\)</span> will have with individuals in group <span class="math inline">\(j\)</span>:</p>
<p><span class="math display" id="eq:chap3-homo-mij">\[\begin{equation}
M_{i,j} = \frac{C_{i,j}}{N_i}\,,
\tag{3.21}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(N_i\)</span> is the number of individuals in group <span class="math inline">\(i\)</span>. We call the matrix in this form the <em>intensive scale</em>. This is the usual format in which this matrix is given. In this case, reciprocity is fulfilled if</p>
<p><span class="math display" id="eq:chap3-homo-reciM">\[\begin{equation}
M_{i,j} N_i = M_{j,i} N_j\,.
\tag{3.22}
\end{equation}\]</span></p>
<p>This last expression rises an interesting question. The reciprocity relation depends on the population in each age bracket, <span class="math inline">\(N_i\)</span>. Thus, if the matrix <span class="math inline">\(M\)</span> was measured in year <span class="math inline">\(y\)</span>, we have that <span class="math inline">\(M_{i,j}(y) N_i(y) = M_{j,i}(y) N_j(y)\)</span>. However, if we want to use this matrix in a different year, that is, with a different demographic structure due to the inherent evolution of the population, reciprocity will no longer be fulfilled, i.e.</p>
<p><span class="math display" id="eq:chap3-homo-reciWrong">\[\begin{equation}
M_{i,j}(y) N_i(y&#39;) \neq M_{j,i}(y) N_j(y&#39;)\,,
\tag{3.23}
\end{equation}\]</span></p>
<p>unless the population has not changed. This is a major problem because there are diseases whose temporal dynamics are comparable to the ones of the demographic evolution. For instance, Tuberculosis is a disease in which age is particularly important and the incubation period ranges from 1 to 30 years <span class="citation">[<a href="references.html#ref-Behr2018" role="doc-biblioref">183</a>]</span>. Hence, to properly forecast the evolution of Tuberculosis in a population it is strictly necessary to project somehow these age-contact matrices into the future <span class="citation">[<a href="references.html#ref-Arregui2018Dec" role="doc-biblioref">134</a>]</span>. Even for diseases that have much shorter dynamics, such as influenza, this is a relevant problem because given how costly these experiments are, it is unpractical to repeat them every few years to obtain updated matrices. As a consequence, if we simply want to study the impact of influenza this year, more than 10 years after the work by Massong et al., we need to devise a way to properly update them.</p>
<p>Figure <a href="chap-chap3.html#fig:chap3-homo-reciprocity">3.3</a> exemplifies, for Poland and Zimbabwe, the error we would make if we do not adapt <span class="math inline">\(M\)</span> and blindly use it with demographic structures that are different than the original. We define the reciprocity error as</p>
<p><span class="math display" id="eq:chap3-homo-reciprocityError">\[\begin{equation}
E = \frac{\sum_{i,j&gt;i} |C_{i,j}-C_{j,i}|}{0.5\cdot \sum_{i,j} C_{i,j}} = \frac{\sum_{i,j&gt;i} | M_{i,j} N_i - M_{j,i} N_j |}{0.5 \cdot \sum_{i,j} M_{i,j} N_i}\,,
\tag{3.24}
\end{equation}\]</span></p>
<p>to quantify the fraction of links that are not reciprocal. The two countries under consideration have very different demographic patterns, both in the past and in the future, and yet we can see that the error is quite large in both of them.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-homo-reciprocity"></span>
<img src="images/Fig_chap3_homo_reciprocity.png" alt="Reciprocity error as a function of time in Poland and Zimbabwe. For each country, in the top plots the demographic structures of 1950 and 2050 are compared to the one existing when the contact matrices were measured. In the bottom plot the reciprocity error as a function of time is shown. For the matrix to be correct in different years the error should be 0, but that only happens in the year when the data was collected." width="607" />
<p class="caption">
Figure 3.3: <strong>Reciprocity error as a function of time in Poland and Zimbabwe.</strong> For each country, in the top plots the demographic structures of 1950 and 2050 are compared to the one existing when the contact matrices were measured. In the bottom plot the reciprocity error as a function of time is shown. For the matrix to be correct in different years the error should be 0, but that only happens in the year when the data was collected.
</p>
</div>

<p>The problem is that both <span class="math inline">\(C_{i,j}\)</span> and <span class="math inline">\(M_{i,j}\)</span> implicitly contain information about the demographic structure of the population at the time they were measured. To solve this problem, we define the <em>intrinsic connectivity matrix</em> as</p>
<p><span class="math display" id="eq:chap3-homo-gamma">\[\begin{equation}
\Gamma_{i,j} = M_{i,j} \frac{N}{N_j}\,.
\tag{3.25}
\end{equation}\]</span></p>
<p>This matrix corresponds, except for a global factor, to the contact pattern in a “rectangular” demography (a population structure where all age groups have the same density). Hence, it does not have any information about the demographic structure of the population.</p>
<p>In figure <a href="chap-chap3.html#fig:chap3-homo-data">3.4</a>A we show the instrinsic connectivity matrices for each of the 16 regions enumerated previously. Interestingly, the contact patterns are quite different from region to region. To facilitate the comparison, in figure <a href="chap-chap3.html#fig:chap3-homo-data">3.4</a>B we plot the fraction of connectivity that corresponds to young individuals (less than 20 years old) as a function of the assortativity of each matrix as defined by Newman <span class="citation">[<a href="references.html#ref-Newman_2018" role="doc-biblioref">73</a>]</span> (this quantity is an adaptation of the Pearson correlation coefficient so that it is equal to 1 if individuals tend to contact those who are like them, -1 in the opposite case and 0 if the pattern is completely uncorrelated). We can see that regions with similar demographic structures and culture tend to cluster together, although it is not possible to disentangle which is the precise cause leading to one pattern or the other.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-homo-data"></span>
<img src="images/Fig_chap3_homo_data.png" alt="Age contact matrices from 16 regions. A) Intrinsic connectivity matrix, \(\Gamma_{i,j}\), of each region. There is not a standard definition of age brackets and thus each study had its own definition. For comparison purposes, we have adapted the data to 15 age brackets: \([0,5),[5,10),\ldots,[65,70),+70\). B) Proportion of connectivity corresponding to individuals younger than 20 versus the assortativity coefficient of each matrix." width="678" />
<p class="caption">
Figure 3.4: <strong>Age contact matrices from 16 regions.</strong> A) Intrinsic connectivity matrix, <span class="math inline">\(\Gamma_{i,j}\)</span>, of each region. There is not a standard definition of age brackets and thus each study had its own definition. For comparison purposes, we have adapted the data to 15 age brackets: <span class="math inline">\([0,5),[5,10),\ldots,[65,70),+70\)</span>. B) Proportion of connectivity corresponding to individuals younger than 20 versus the assortativity coefficient of each matrix.
</p>
</div>

<p>With this matrix we can now easily compute <span class="math inline">\(M\)</span> at any other time, as long as we know the demographic structure of the population at that time:</p>
<p><span class="math display" id="eq:chap3-homo-M2">\[\begin{equation}
M_{i,j} (y&#39;) = \Gamma_{i,j} \frac{N_j(y&#39;)}{N(y&#39;)} = M_{i,j}(y) \frac{N(y)N_j(y&#39;)}{N_j(y)N(y&#39;)}\,.
\tag{3.26}
\end{equation}\]</span></p>
<p>In our case, we will obtain this data from the UN population division database, which contains information of both the past demographic structures and their projections to 2050 for the whole world <span class="citation">[<a href="references.html#ref-UNdatabase" role="doc-biblioref">184</a>]</span>.</p>
<p>We conclude this section addressing how this correction impacts disease modeling. To this end, we simulate the spreading of an influenza-like disease both with and without corrections on the matrix. We choose influenza because it is a short-cycle disease so that we can assume that the population structure is constant during each simulated outbreak. Besides, it can be effectively modeled using the SEIR model presented in <a href="chap-chap3.html#subsec:chap3-homo-age">3.1.1</a>.</p>
<p>To parameterize the model we use the values of an influenza outbreak that took place in Belgium in the season 2008/2009 <span class="citation">[<a href="references.html#ref-DeLuca2018Dec" role="doc-biblioref">132</a>]</span>. Thus, individuals can catch the disease with transmissibility rate <span class="math inline">\(\beta\)</span> per-contact with an infectious individual. The value of <span class="math inline">\(\beta\)</span> is determined in each simulation so that the basic reproductive number is equal to <span class="math inline">\(2.12\)</span> using the next generation approach (this procedure will be explained in more detail in section <a href="chap-chap3.html#sec:chap3-R0">3.2</a>) <span class="citation">[<a href="references.html#ref-DeLuca2018Dec" role="doc-biblioref">132</a>], [<a href="references.html#ref-vandenDriessche2002Nov" role="doc-biblioref">185</a>]</span>. Once infected, individuals remain on a latency state for <span class="math inline">\(\sigma^{-1} = 1.1\)</span> days on average. Then, they become infectious for <span class="math inline">\(\mu^{-1} = 3\)</span> days on average, period when they can transmit the infection to susceptible individuals. After that, they recover and become immune to the disease. We use a discrete and stochastic model with the population divided into 15 age classes, whose mixing is given by the age contact matrix <span class="math inline">\(M\)</span>. To sum up:</p>
<ul>
<li>The probability of an individual belonging to age group <span class="math inline">\(i\)</span> to get infected is</li>
</ul>
<p><span class="math display" id="eq:chap3-homo-pe">\[\begin{equation}
p_{S\rightarrow E} = \beta \sum_j \frac{M_{i,j}}{N_j} I_j\,.
\tag{3.27}
\end{equation}\]</span></p>
<ul>
<li>Once in the latent state, the probability of entering the infected state is</li>
</ul>
<p><span class="math display" id="eq:chap3-homo-pi">\[\begin{equation}
p_{E\rightarrow I} = \sigma\,.
\tag{3.28}
\end{equation}\]</span></p>
<ul>
<li>Finally, an infected individual will recover with probability</li>
</ul>
<p><span class="math display" id="eq:chap3-homo-pr">\[\begin{equation}
p_{I\rightarrow R} = \mu\,.
\tag{3.29}
\end{equation}\]</span></p>
<p>Under these conditions, we compute the predicted size of the epidemic, i.e., <span class="math inline">\(R(t\rightarrow \infty)\)</span>, in years 2000 and 2050. In figure <a href="chap-chap3.html#fig:chap3-homo-difference">3.5</a> we present the results. In particular, in A we show the difference between the predicted size of the epidemic in 2050 versus the one in 2000 using the same <span class="math inline">\(M\)</span> matrix in both years. In almost all countries the final size of the epidemic is smaller in 2050, except for China and the African countries in which it increases. However, in B we repeat the analysis but using the adapted values of <span class="math inline">\(M(y&#39;)\)</span> obtained using <a href="chap-chap3.html#eq:chap3-homo-M2">(3.26)</a>. In this case, in general, the situation is reversed. Most countries have larger epidemics, except for the African ones. Even more, in countries such as China and Japan the difference is quite large, close to 20%.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-homo-difference"></span>
<img src="images/Fig_chap3_homo_difference.png" alt="Predictions of influenza incidence in 2050 with demographic corrections. In both plots the black horizontal line starts at the median age of each region in the year 2000 and ends with a bullet point with the predicted value in 2050. Color bars denote the relative variation of incidence over the same period. In A the predictions are computed using the original contact matrices collected from the surveys. In B the proposed demographic corrections are applied to the matrices." width="678" />
<p class="caption">
Figure 3.5: <strong>Predictions of influenza incidence in 2050 with demographic corrections.</strong> In both plots the black horizontal line starts at the median age of each region in the year 2000 and ends with a bullet point with the predicted value in 2050. Color bars denote the relative variation of incidence over the same period. In A the predictions are computed using the original contact matrices collected from the surveys. In B the proposed demographic corrections are applied to the matrices.
</p>
</div>

<p>Summarizing, to create more realistic models we need to incorporate empirically measured data. However, blindly using data without thinking whether it can be applied to the specific system we are studying is not adequate. In the particular case of social mixing matrices, we have seen that even if we keep studying the same country, just moving a few years away from the moment in which the experiment took place dramatically affects the reciprocity of the contacts. This, in turn, leads to important differences in the global incidence for influenza-like diseases, as we have shown in our analysis of the SEIR model. Even more, since there are different intrinsic connectivity patterns across countries, it is possible that there exists a time evolution of this quantity. Indeed, if we believe that the intrinsic pattern is a consequence of the culture of the country, it seems logical to think that an evolving culture will also have evolving intrinsic connectivity patterns. Although predicting how society will change in the future is currently impossible, this should be taken into account as a limitation in any forecast for which heterogeneity in social mixing is a key element.</p>
</div>
</div>
<div id="sec:chap3-R0" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> The basic reproduction number</h2>
<p>One of the cornerstones of modern epidemiology is the <em>basic reproduction number</em>, <span class="math inline">\(R_0\)</span>, defined as the expected number of individuals infected by a single infected person during her entire infectious period in a population which is entirely susceptible. From this definition, it is clear that if <span class="math inline">\(R_0&lt;1\)</span>, then, each infected individual will produce, on average, less than one infection. Therefore, the disease will not be able to be sustained in the population. Conversely, if <span class="math inline">\(R_0&gt;1\)</span> the disease will be able to propagate to a macroscopic fraction of the population. Hence, this simple dimensionless quantity is informing us of three key aspects of a disease: (1) whether the disease will be able to invade the population, at least initially; (2) a way to determine which control measures, and at what magnitude, would be the most effective, i.e., which ones will reduce <span class="math inline">\(R_0\)</span> below 1; (3) to gauge the risk of an epidemic in emerging infectious diseases <span class="citation">[<a href="references.html#ref-Heffernan2005" role="doc-biblioref">186</a>]</span>.</p>
<p>Interestingly, despite its importance, this quantity was not originated in epidemiology. The concept of <span class="math inline">\(R_0\)</span>, and its notation, was formalized by Dublin and Lotka, in 1925, in the context of demography<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>
<span class="citation">[<a href="references.html#ref-Dublin1925" role="doc-biblioref">188</a>]</span>. The similitude of the concept in both fields is obvious, in one it measures the number of new infections per infected while in the other the number of births per female. Yet, in epidemiology the concept was mostly unknown until Anderson and May popularized it 60 years later in the Dahlem conference <span class="citation">[<a href="references.html#ref-anderson1982" role="doc-biblioref">189</a>]</span> (see <span class="citation">[<a href="references.html#ref-Heesterbeek2002Sep" role="doc-biblioref">190</a>]</span> for a nice historical discussion on why it took so long for this concept to mature in epidemiology).</p>
<p>It might be enlightening to introduce the mathematical definition from the point of view of demography. Consider a large population. Let <span class="math inline">\(F_d(a)\)</span> be the survival function, i.e., the probability for a new-born individual to survive at least to age <span class="math inline">\(a\)</span>, and let <span class="math inline">\(b(a)\)</span> denote the average number of offspring that an individual will produce per unit of time at age <span class="math inline">\(a\)</span>. The function <span class="math inline">\(n(a) \equiv b(a) F_d(a)\)</span> is called the reproduction function. Hence, the expected future offspring of a new-born individual, <span class="math inline">\(R_0\)</span>, is <span class="citation">[<a href="references.html#ref-Heesterbeek1996Mar" role="doc-biblioref">191</a>]</span></p>
<p><span class="math display" id="eq:chap3-r0-demo">\[\begin{equation}
R^{demo}_0 \equiv \int_0^\infty n(a) \text{d} a = \int_0^\infty b(a) F_d(a) \text{d}a\,.
\tag{3.30}
\end{equation}\]</span></p>
<p>The translation of this definition to epidemiology is straightforward. First, note that the reproduction function at age <span class="math inline">\(a\)</span> is equivalent to the expected infectivity of an individual who was infected <span class="math inline">\(\tau\)</span> units of time ago, <span class="math inline">\(A(\tau)\)</span> (see equation <a href="chap-chap3.html#eq:chap3-homo-A">(3.4)</a>). There is, however, one crucial difference. While in demography it is possible to “create” new individuals regardless of the size of the rest of the population, in epidemiology the creation of new individuals depends both on the infectivity and on the amount of susceptible individuals in the population. Hence,</p>
<p><span class="math display" id="eq:chap3-r0-definition">\[\begin{equation}
R_0(\eta) \equiv \int_\Omega S(\xi) \int_0^\infty A(\tau,\xi,\eta)\text{d}\tau \text{d}\xi\,.
\tag{3.31}
\end{equation}\]</span></p>
<p>This rather cryptic expression is the most general definition of this quantity <span class="citation">[<a href="references.html#ref-Diekmann1990Jun" role="doc-biblioref">192</a>]</span>, although we will see in a moment simpler ones. The expression should be read as follows: the value of <span class="math inline">\(R_0\)</span> for individuals in an infectious state <span class="math inline">\(\eta\)</span> is equal to the sum of all individuals in a susceptible state characterized by <span class="math inline">\(\xi\)</span>, of size <span class="math inline">\(\Omega\)</span>, times the infectivity of individuals in said state <span class="math inline">\(\eta\)</span> who where infected <span class="math inline">\(\tau\)</span> steps ago and can infect individuals in state <span class="math inline">\(\xi\)</span>.</p>
<p>In the particular case of the SIR model under the density dependent approach, equation <a href="chap-chap3.html#eq:chap3-homo-homo">(3.9)</a>, the basic reproduction number is simply</p>
<p><span class="math display" id="eq:chap3-r0-sir">\[\begin{equation}
\begin{split}
R_0 &amp; = S_0 \int_0^\infty A(\tau) \text{d}\tau = S_0 \int_0^\infty \beta e^{-\mu \tau} \text{d}\tau \\
	&amp; = \frac{\beta S_0}{\mu}\,,
\end{split}
\tag{3.32}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(S_0\)</span> is the number of susceptible individuals at the beginning of the infection, which in the absence of immunized individuals is equal to <span class="math inline">\(N\)</span>. Recall that the linear stability analysis of the SIR model <a href="chap-chap3.html#eq:chap3-homo-i1lin">(3.12)</a> yields,</p>
<p><span class="math display" id="eq:chap3-r0-sirStability">\[\begin{equation}
i(t) = i_0 e^{\beta N- \mu}\,,
\tag{3.33}
\end{equation}\]</span></p>
<p>which only grows if <span class="math inline">\(\beta N &gt; \mu\)</span>. In other words, <span class="math inline">\(R_0\)</span> defines precisely the epidemic threshold that we found in the previous section, i.e.,</p>
<p><span class="math display" id="eq:chap3-r0-th">\[\begin{equation}
R_0 = \frac{\beta N}{\mu} &gt; 1\,,
\tag{3.34}
\end{equation}\]</span></p>
<p>as heuristically discussed at the beginning of this section. In the frequency dependent approach, which is more common in the network science literature as we shall see in <a href="chap-chap3.html#sec:chap3-directed">3.3</a>, the basic reproduction number<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> is</p>
<p><span class="math display" id="eq:chap3-r0-th2">\[\begin{equation}
R_0 = \frac{\beta}{\mu} &gt; 1\,.
\tag{3.35}
\end{equation}\]</span></p>
<p>To obtain an explicit expression for <span class="math inline">\(R_0\)</span> with more complex compartmental models, an alternative approach to linear stability analysis is the <em>next generation matrix</em> as proposed by Diekmann in 1990 <span class="citation">[<a href="references.html#ref-Diekmann1990Jun" role="doc-biblioref">192</a>]</span> and further elaborated by van den Driessche and Watmough in 2002 <span class="citation">[<a href="references.html#ref-vandenDriessche2002Nov" role="doc-biblioref">185</a>]</span>. Briefly, the idea is to study the stability of the disease free state, <span class="math inline">\(x_0\)</span>. To do so, we restrict the model to those compartments with infected individuals and separate the evolution due to new individuals getting infected, <span class="math inline">\(\mathcal{F}\)</span>, and the transitions resulting for any other reason,</p>
<p><span class="math display" id="eq:chap3-r0-ngm1">\[\begin{equation}
\frac{\text{d}x_i(t)}{\text{d}t} = \mathcal{F}_i(x) - \mathcal{V}_i(x)\,,
\tag{3.36}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(x = (x_1,\ldots,x_m)\)</span> denotes the <span class="math inline">\(m\)</span> infected states in the model. If we now define</p>
<p><span class="math display" id="eq:chap3-r0-ngm2">\[\begin{equation}
F = \left[\frac{\partial \mathcal{F}_i(x_0)}{\partial x_j}\right]
 \text{~~and~~} 
 V = \left[\frac{\partial \mathcal{V}_i(x_0)}{\partial x_j}\right]\,,
\tag{3.37}
\end{equation}\]</span></p>
<p>the next generation matrix is <span class="math inline">\(FV^{-1}\)</span> and the basic reproductive number can be obtained as</p>
<p><span class="math display" id="eq:chap3-r0-ngm3">\[\begin{equation}
R_0 = \rho(FV^{-1})\,
\tag{3.38}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\rho\)</span> denotes the spectral radius <span class="citation">[<a href="references.html#ref-vandenDriessche2017Aug" role="doc-biblioref">193</a>]</span>. In particular, for the model considered in section <a href="chap-chap3.html#subsec:chap3-homo-demo">3.1.2</a>, the next generation matrix reads</p>
<p><span class="math display" id="eq:chap3-r0-ngm4">\[\begin{equation}
K_{i,j} = \frac{\beta}{\mu} \frac{M_{i,j}}{N_j}\,.
\tag{3.39}
\end{equation}\]</span></p>
<p>This expression can be used to ensure that, regardless of the values of <span class="math inline">\(M_{i,j}\)</span> and <span class="math inline">\(N_j\)</span>, the starting point of the dynamics is the same. For this reason, when we wanted to address the differences in incidence consequence of the changing demographics, we fitted <span class="math inline">\(\beta\)</span> so that the spectral radius of <a href="chap-chap3.html#eq:chap3-r0-ngm4">(3.39)</a> was always <span class="math inline">\(R_0 = 2.12\)</span>.</p>
<p>It is worth pointing out that <span class="math inline">\(R_0\)</span> clearly depends on the model we choose for the dynamics. As a consequence, even though its epidemiological definition is completely independent from models (number of secondary infections per infected individual in a fully susceptible population), its mathematical formulation is not univocal. Ideally, if in a disease outbreak we knew who infected whom, we would be able to obtain the exact value of <span class="math inline">\(R_0\)</span>. In reality, however, this information is seldom available. Hence, to compute it, one often relies on aggregated quantities, such as <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\mu\)</span> in equation <a href="chap-chap3.html#eq:chap3-r0-th2">(3.35)</a>. The problem is that if we assume that a disease can be modeled within a specific framework, we cannot directly compare the value obtained for <span class="math inline">\(R_0\)</span> with the ones measured for other diseases unless the exact same model has been used to obtain it. This is one of the observations that will motivate our work, which we will describe in section <a href="chap-chap3.html#subsec:chap3-r0-pnas">3.2.3</a>.</p>
<div id="subsec:chap3-r0-measure" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Measuring <span class="math inline">\(\mathbf{R_0}\)</span></h3>
<p>Measuring <span class="math inline">\(R_0\)</span> is not an easy task, specially in the case of emergent diseases for which fast forecasts are required. An accurate estimation of its value is crucial to planning for the control of an infection, but usually the only available information about the transmissibility of a new infectious disease is restricted to the daily count of new cases. Fortunately, it is possible, under certain conditions, to obtain an expression for <span class="math inline">\(R_0\)</span> as a function of that data.</p>
<p>Following <span class="citation">[<a href="references.html#ref-Wallinga2006Nov" role="doc-biblioref">194</a>]</span>, we will assume that in the beginning of a disease outbreak the growth of the number of infected individuals is exponential. Hence, the number of new infected individuals at time <span class="math inline">\(t\)</span> will be equal to the number of new infected individuals <span class="math inline">\(\tau\)</span> time units ago, multiplied by the exponential growth,</p>
<p><span class="math display" id="eq:chap3-r0-rTg1">\[\begin{equation}
\frac{\text{d}S(t)}{\text{d}t} = \frac{\text{d}S(t-\tau)}{\text{d}t} e^{r\tau}\,
\tag{3.40}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(r\)</span> denotes the growth rate. Inserting this expression in <a href="chap-chap3.html#eq:chap3-homo-original">(3.1)</a> with <span class="math inline">\(t\rightarrow 0\)</span>,</p>
<p><span class="math display" id="eq:chap3-r0-rTg2">\[\begin{equation}
\frac{\text{d}S(t)}{\text{d}t} = S(t=0) \int_0^\infty A(\tau) \frac{\text{d}S(t)}{\text{d}t} e^{-r\tau} \text{d}\tau
\Rightarrow 1 = S_0 \int_0^\infty A(\tau) e^{-r\tau} \text{d}\tau 
\tag{3.41}
\end{equation}\]</span></p>
<p>At this point it might be enlightening to return once again to the demographic simile. In equation <a href="chap-chap3.html#eq:chap3-r0-demo">(3.30)</a> we saw that the total number of offspring of a person could be obtained integrating <span class="math inline">\(n(a)\)</span> (rate of reproduction at age <span class="math inline">\(a\)</span>) over the whole lifespan of the individual. Thus, we can define the distribution of the age a person has when she has a child as</p>
<p><span class="math display" id="eq:chap3-r0-rTg3">\[\begin{equation}
g&#39;(a) = \frac{n(a)}{\int_0^\infty n(a) \text{d} a } = \frac{n(a)}{R_0^{demo}}\,.
\tag{3.42}
\end{equation}\]</span></p>
<p>If we take the “age” of an infection to be the time since the infection, we can define an analogous quantity in epidemiology,</p>
<p><span class="math display" id="eq:chap3-r0-rTg4">\[\begin{equation}
g(\tau) = \frac{S_0 A(\tau)}{R_0}\,,
\tag{3.43}
\end{equation}\]</span></p>
<p>called <em>generation interval distribution</em>. In this case this distribution is the probability distribution function for the time from infection of an individual to the infection of a secondary case by that individual. Going back to <a href="chap-chap3.html#eq:chap3-r0-rTg2">(3.41)</a> we now have</p>
<p><span class="math display" id="eq:chap3-r0-rTg5">\[\begin{equation}
\frac{1}{R_0} = \int_0^\infty g(\tau) e^{-r\tau} \text{d}\tau\,.
\tag{3.44}
\end{equation}\]</span></p>
<p>According to this last expression, the shape of the generation interval distribution determines the relation between the basic reproduction number <span class="math inline">\(R_0\)</span> and the growth rate <span class="math inline">\(r\)</span>. In all the models explored so far, we assumed that both the rate of infection <span class="math inline">\(\beta\)</span> and the rate of leaving the infectious stage <span class="math inline">\(\mu\)</span> were constant. Hence, it follows that the duration of a generation interval is specified as an exponential distribution with mean <span class="math inline">\(Tg = 1/\mu\)</span>. Under these assumptions the basic reproduction number is then</p>
<p><span class="math display" id="eq:chap3-r0-rTg">\[\begin{equation}
\begin{split}
R_0 &amp; = \left( \int_0^\infty \mu e^{-\mu\tau} e^{-r\tau} \text{d} \tau\right)^{-1} = \left( \frac{\mu}{r+\mu} \right)^{-1} \\
	&amp; = 1 + rTg \,.
\end{split}
\tag{3.45}
\end{equation}\]</span></p>
<p>This relation between the growth rate and the generation time was already proposed by Dietz in 1976 <span class="citation">[<a href="references.html#ref-Dietz1976" role="doc-biblioref">195</a>]</span>, although only in the specific case of the SIR model. Equation <a href="chap-chap3.html#eq:chap3-r0-rTg5">(3.44)</a>, however, allows for the calculation of <span class="math inline">\(R_0\)</span> in more complex scenarios, such as non constant <span class="math inline">\(\mu\)</span> <span class="citation">[<a href="references.html#ref-Wallinga2006Nov" role="doc-biblioref">194</a>]</span>. Despite its limitations, this expression is widely used in the literature due to its simplicity. Indeed, <span class="math inline">\(Tg\)</span> is often considered to be simply the inverse of the recovery rate, which is relatively easy to measure. Thus, <span class="math inline">\(r\)</span> can be obtained by fitting a straight line to the cumulative number of infections as a function of time, see <a href="chap-chap3.html#eq:chap3-r0-rTg1">(3.40)</a>.</p>
<p>There are, however, several problems with this procedure. First, we stated that the exponential growth is valid during the early phase of an outbreak, but there is no way to know how long is that in general. As a consequence, when one fits a straight line to the data, some heuristics have to be used to determine which points to use. Even more, if the dynamics is really fast there might be just a few valid points. Given the stochasticity of the process, this might lead to poor estimates of the growth rate.</p>
<p>Besides, there are some caveats on the exponential growth assumption. For instance, it has been observed that for some diseases such as AIDS/HIV the early growth is sub-exponential <span class="citation">[<a href="references.html#ref-Viboud2016Jun" role="doc-biblioref">196</a>]</span>. Likelihood based methods in which the early exponential growth is not needed were thus proposed <span class="citation">[<a href="references.html#ref-Nishiura2010Jan" role="doc-biblioref">197</a>], [<a href="references.html#ref-White2008Jul" role="doc-biblioref">198</a>]</span>. But even for diseases in which it might be a good approximation, there is the problem of susceptible depletion. Indeed, if the population is infinite, each infected individual will be always able to reach an infinite amount of susceptibles. But this is not true in real situations, forbidding the exponential growth to be sustained for too long. Hence, methods that account for this depletion during the initial phase had also to be developed <span class="citation">[<a href="references.html#ref-Ma2014Jan" role="doc-biblioref">199</a>], [<a href="references.html#ref-Chowell2016Sep" role="doc-biblioref">200</a>]</span>.</p>
<p>It should be clear by now that despite the widespread use of this parameter, it is far from being perfectly understood, specially in the presence of real world data. Yet, we can go one step further and generalize the definition of <span class="math inline">\(R_0\)</span> to the <em>effective reproduction number</em>, <span class="math inline">\(R(t)\)</span>.</p>
</div>
<div id="subsec:chap3-r0-Ref" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> The effective reproduction number</h3>
<p>The effective reproduction number, <span class="math inline">\(R(t)\)</span>, is defined as the average number of secondary cases generated by an infectious individual at time <span class="math inline">\(t\)</span>. Hence, we are relaxing the hypothesis of a fully susceptible population that we gave at the beginning of section <a href="chap-chap3.html#sec:chap3-R0">3.2</a>.</p>
<p>This parameter is obviously better suited for studying the impact of protection measures taken after the detection of an epidemic, as it can be defined at any time. If <span class="math inline">\(R(t)&lt;1\)</span>, it seems reasonable to say that the epidemic is in decline and may be regarded as being under control at time <span class="math inline">\(t\)</span>. Furthermore, in section <a href="chap-chap3.html#subsec:chap3-homo-age">3.1.1</a> we saw that diseases such as measles have periodic outbreaks and also convey immunity to those who have suffered it. Thus, when a new outbreak starts the population is not completely susceptible, invalidating one of the conditions in the definition of <span class="math inline">\(R_0\)</span> <span class="citation">[<a href="references.html#ref-CintronArias2009Apr" role="doc-biblioref">201</a>]</span>.</p>
<p>To provide a mathematical definition of <span class="math inline">\(R(t)\)</span> <span class="citation">[<a href="references.html#ref-Nishiura2009" role="doc-biblioref">202</a>]</span>, we can revisit equation <a href="chap-chap3.html#eq:chap3-r0-sir">(3.32)</a> and define</p>
<p><span class="math display" id="eq:chap3-r0-rt">\[\begin{equation}
R(t) = S(t) \int_0^\infty A(\tau)\text{d}\tau\,,
\tag{3.46}
\end{equation}\]</span></p>
<p>which leads to</p>
<p><span class="math display" id="eq:chap3-r0-rt2">\[\begin{equation}
R(t) = \frac{S(t)}{S_0} R_0\,.
\tag{3.47}
\end{equation}\]</span></p>
<p>According to this expression, in a closed population, the value of <span class="math inline">\(R(t)\)</span> should monotonically decrease. As expected, this has been observed in computational simulations <span class="citation">[<a href="references.html#ref-CintronArias2009Apr" role="doc-biblioref">201</a>]</span>, even in the case of sub-exponential growth <span class="citation">[<a href="references.html#ref-Chowell2016Oct" role="doc-biblioref">203</a>]</span>. However, this is not always the case if one tries to obtain <span class="math inline">\(R(t)\)</span> from real data <span class="citation">[<a href="references.html#ref-Paine2010Jun" role="doc-biblioref">204</a>]</span>. In particular, Walling and Teunis studied the severe acute respiratory syndrome (SARS) epidemic from 2003 and observed several local maxima in the evolution of the effective reproduction number, which they attributed to “super-spread events” in which certain individuals infected unusually large numbers of secondary cases <span class="citation">[<a href="references.html#ref-Wallinga2004Sep" role="doc-biblioref">205</a>]</span>. This was also found in other diseases, signaling that the whole complexity of real systems cannot be completely captured with simple homogeneous models <span class="citation">[<a href="references.html#ref-LloydSmith2005Nov" role="doc-biblioref">206</a>]</span>. For this reason, the next section will be devoted to our contribution in the study of the effect that more heterogeneous population distributions have on the reproduction numbers.</p>
</div>
<div id="subsec:chap3-r0-pnas" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Measurability of the epidemic reproduction number</h3>
<blockquote>
<p>Of course, there had been plenty of diseases, long before humans had been around. But humans had definitely created Pestilence. They had a genius for crowding together, for poking around in jungles, for setting the midden so handily next to the well. Pestilence was, therefore, part human, with all that this entailed.<br />
<em>“Thief of time”</em>, Terry Pratchett</p>
</blockquote>
<p>The fundamental role that households play in the spreading of epidemics has been acknowledged for a long time. Early estimations of influenza spreading already showed that the probability of getting infected from someone living in your household or someone from the community were quite different. Even more, it was shown that children were twice more likely to get the infection from the community than adults, signaling that the places that children visit and the own heterogeneity of household members are fundamental in the disease dynamics <span class="citation">[<a href="references.html#ref-Longini1982May" role="doc-biblioref">207</a>]</span>. In a more recent study, data from a real epidemic in a small semi-rural community was analyzed, with schools added explicitly into the picture. As expected, it was observed that their role is key in the spreading of the disease. But, even more interesting, the authors calculated a reproduction number for each population structure and found it to be smaller or of the order of 1, meaning that for an outbreak to be sustained a complex interplay between those structures must take place <span class="citation">[<a href="references.html#ref-Cauchemez2011Feb" role="doc-biblioref">208</a>]</span>.</p>
<p>In order to introduce the concept of households into the models analyzed so far, we need to revisit once again the assumption of full homogeneity. Most theoretical approaches in this line, since the seminal work of Ball et al. in 1997 <span class="citation">[<a href="references.html#ref-Ball1997Feb" role="doc-biblioref">209</a>]</span>, have focused on what is known as models with two levels of mixing. In these models, a local homogeneous mixing in small environments (such as households) is set over a background homogeneous mixing of the whole population. This can be further extended by adding other types of local interactions, such as schools or workplaces. An individual can thus belong at the same time to two or more local groups. For this reason, they are also known as overlapping group models <span class="citation">[<a href="references.html#ref-Pellis2011Oct" role="doc-biblioref">210</a>]</span>. This allows for the definition of several basic reproduction numbers, one for the community and the rest for local interactions, which in turn can be used to devise efficient vaccination strategies <span class="citation">[<a href="references.html#ref-Becker1995Jun" role="doc-biblioref">211</a>], [<a href="references.html#ref-House2008May" role="doc-biblioref">212</a>]</span>. Other studies have also proposed that the generation time can differ from within households and the community <span class="citation">[<a href="references.html#ref-Fraser2007Aug" role="doc-biblioref">213</a>]</span>.</p>
<p>However, theoretical studies have been mostly focused on the early phase of the epidemics because it is more mathematically tractable. Yet, we have seen in the previous section that <span class="math inline">\(R(t)\)</span> can provide very important insights to understand the dynamics of real diseases. For this reason, statistical methods have been developed to analyze <span class="math inline">\(R(t)\)</span> <span class="citation">[<a href="references.html#ref-Ajelli2015Dec" role="doc-biblioref">214</a>], [<a href="references.html#ref-Ajelli2016Dec" role="doc-biblioref">215</a>]</span>. Unfortunately, for these methods, disentangling the role that each structure of the system plays is challenging due to the lack of microscale data on human contact patterns for large populations. Note also that due to the typically small size of households, stochastic effects are highly important.</p>
<p>In this work our objective is to shed some light into the mechanisms behind disease dynamics in heterogeneous populations. To do so, we study the evolution of <span class="math inline">\(R(t)\)</span> and <span class="math inline">\(Tg\)</span> with data-driven stochastic micro-simulations of an influenza-like outbreak on a highly detailed synthetic population. The term “micro” refers to the fact that we will keep track of each individual in the population, allowing us to reconstruct the entire transmission chain. The great advantage of this method is that it allows for the computation of <span class="math inline">\(R(t)\)</span> from its own epidemiological definition, without requiring any mathematical approximation.</p>
<p>Our synthetic population is composed by 500,000 agents, representing a subset of the Italian population. This population model, developed by Fumanelli et al. <span class="citation">[<a href="references.html#ref-Fumanelli2012Sep" role="doc-biblioref">216</a>]</span>, divides the system into the four settings where influenza transmission occurs, namely households, schools, workplaces and the general community <span class="citation">[<a href="references.html#ref-Merler2011Sep" role="doc-biblioref">217</a>]</span>. Henceforth we will refer to these settings as <em>layers</em> for the similarity of this construction to the multilayer networks we saw in section <a href="chap-chap2.html#subsec:chap2-multilayer">2.1.3</a><a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>; a visualization of the model is shown in <a href="chap-chap3.html#fig:chap3-r0-scheme">3.6</a>A. The household layer is composed by <span class="math inline">\(n_H\)</span> disconnected components, each one representing one household. The amount of individuals inside each household is determined by sampling from the actual Italian household size distribution, as well as their age. Then, by sampling from the multinomial distribution of schooling and employment rates by age, each individual might be also assigned to a school or workplace. Both the number and size of workplaces and schools is also sampled from the actual Italian distribution. As in the household layer, each of the <span class="math inline">\(n_S\)</span> schools and <span class="math inline">\(n_W\)</span> workplaces are disconnected from the rest in their respective layers. Lastly, all individuals are allowed to interact with each other in the community layer, encapsulating the background global interaction. To highlight the heterogeneity of the system, in figure <a href="chap-chap3.html#fig:chap3-r0-scheme">3.6</a>B the size distribution of the places each individual belongs to is shown. Note that while most households contain 2-3 individuals and most schools are close to 1,000 students, workplaces cover a much wider range of sizes.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-r0-scheme"></span>
<img src="images/Fig_chap3_r0_scheme.png" alt="Model structure of a synthetic population organized in schools, households and workplaces. A) Visualization of the overlapping system, with individuals being able to interact locally in multiple contexts. B) Distribution of the structure size each individual belongs to. C) Illustration of the transmission process with an example of how to calculate the reproduction number and generation interval." width="482" />
<p class="caption">
Figure 3.6: <strong>Model structure of a synthetic population organized in schools, households and workplaces.</strong> A) Visualization of the overlapping system, with individuals being able to interact locally in multiple contexts. B) Distribution of the structure size each individual belongs to. C) Illustration of the transmission process with an example of how to calculate the reproduction number and generation interval.
</p>
</div>

<p>The influenza-like transmission dynamics are defined through the susceptible, infected, removed (SIR) compartmental model that we have been analyzing under diverse assumptions. We simulate the transmission dynamics using a stochastic process for each individual, keeping track of where she contracted the disease, who is in contact with and so on. In order to resemble an influenza-like disease, the local spreading power in each layer is calibrated in such a way that the fraction of cases in the four layers is in agreement with literature values (namely, 30% of all influenza infections are linked to transmission occurring in the household setting, 18% in schools, 19% in workplaces and 33% in the community <span class="citation">[<a href="references.html#ref-Merler2010Feb" role="doc-biblioref">218</a>]</span>). Hence, the probability that individual <span class="math inline">\(j\)</span> infects <span class="math inline">\(i\)</span> in layer <span class="math inline">\(l\)</span> is</p>
<p><span class="math display" id="eq:chap3-r0-pinf">\[\begin{equation}
\beta = w_l\,,
\tag{3.48}
\end{equation}\]</span></p>
<p>as long as <span class="math inline">\(j\)</span> is infected, <span class="math inline">\(i\)</span> is susceptible and both belong to the same component in layer <span class="math inline">\(l\)</span>. Moreover, we set the values of <span class="math inline">\(w_l\)</span> such that the basic reproduction number is <span class="math inline">\(R_0=1.3\)</span> <span class="citation">[<a href="references.html#ref-Biggerstaff2014Dec" role="doc-biblioref">219</a>]</span>. Finally, the removal probability, <span class="math inline">\(\mu\)</span>, is set so that the removal time is 3 days <span class="citation">[<a href="references.html#ref-Cowling2009May" role="doc-biblioref">220</a>]</span>.</p>
<p>The epidemic starts with a fully susceptible population in which we set just one individual as infected. Thanks to the microscopic detail of the model, we can thus compute the basic reproduction number directly as the number of infections that said first individual produces before recovery. Its counterpart over time, the effective reproduction number, <span class="math inline">\(R(t)\)</span>, is measured using the average number of secondary cases generated by an infectious individual at time <span class="math inline">\(t\)</span>. Similarly, we also define the effective reproduction number in layer <span class="math inline">\(l\)</span>, <span class="math inline">\(R_l(t)\)</span>, as the average number of secondary infections generated by a typical infectious individual in layer <span class="math inline">\(l\)</span>:</p>
<p><span class="math display" id="eq:chap3-r0-rl">\[\begin{equation}
R_l(t) = \frac{\sum_{i\in \mathcal{I}(t)} D_l(i)}{|\mathcal{I}(t)|}\,,
\tag{3.49}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathcal{I}(t)\)</span> represents the set of infectious individuals that acquired the infection at time <span class="math inline">\(t\)</span> and <span class="math inline">\(D_l(i)\)</span> the number of infections generated by infectious node <span class="math inline">\(i\)</span> in layer <span class="math inline">\(l\)</span> with <span class="math inline">\(l \in L=\{H,S,W,C\}\)</span>. With this expression we can obtain the overall reproductive number as</p>
<p><span class="math display" id="eq:chap3-r0-Rt">\[\begin{equation}
R(t) = \sum_{l\in L} R_l(t)\,.
\tag{3.50}
\end{equation}\]</span></p>
<p>The generation time <span class="math inline">\(Tg\)</span> is defined as the average time interval between the infection time of infectors and their infectees. Hence, analogously to the reproduction number, we define the generation time in layer <span class="math inline">\(l\)</span> as</p>
<p><span class="math display" id="eq:chap3-r0-Tgl">\[\begin{equation}
{Tg}_l = \frac{\sum_{i\in \mathcal{I}(t)} \sum_{j \in \mathcal{I}&#39;_l(i)} (\tau(j)-t)}{\sum_{i \in \mathcal{I}(t)} D_l(i)}\,,
\tag{3.51}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathcal{I}&#39;_l(i)\)</span> denotes the set of individuals that <span class="math inline">\(i\)</span> infected in layer <span class="math inline">\(l\)</span> and <span class="math inline">\(\tau(j)\)</span> is the time when node <span class="math inline">\(j\)</span> acquired the infection. Therefore, the overall generation time <span class="math inline">\(Tg(t)\)</span> reads</p>
<p><span class="math display" id="eq:chap3-r0-Tg">\[\begin{equation}
Tg(t) = \frac{\sum_{l\in L}\sum_{i \in \mathcal{I}(t)} \sum_{j \in \mathcal{I}&#39;_l(i)} (\tau(j)-t)}{\sum_{l\in L}\sum_{i\in \mathcal{I}(t)} D_l(i)}\,.
\tag{3.52}
\end{equation}\]</span></p>
<p>A schematic illustration of the transmission dynamics is shown in figure <a href="chap-chap3.html#fig:chap3-r0-scheme">3.6</a>C. In that case, individual 1 gets infected at <span class="math inline">\(t=t_0\)</span>, while individuals 2 and 3 are still susceptible. During the course of her disease individual 1 infects individual 2 at <span class="math inline">\(t=t_1\)</span> and individual 3 at <span class="math inline">\(t=t_2\)</span> before finally getting recovered at <span class="math inline">\(t=t_3\)</span>. Thus, her reproduction number is equal to 2 and her generation time is <span class="math inline">\(1.5\)</span>, supposing that <span class="math inline">\(t_{i+1} - t_i = 1\)</span>. In fact, in our simulations we will set <span class="math inline">\(\Delta t = 1\)</span> day. Due to the stochasticity of the process, each realization might result in an outbreak of different length. Hence, the time evolution of each simulation is aligned so that the peak of the epidemic is exactly at <span class="math inline">\(t=0\)</span>. The results for the reproduction number and generation time are shown in figure <a href="chap-chap3.html#fig:chap3-r0-r0tg">3.7</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-r0-r0tg"></span>
<img src="images/Fig_chap3_r0_r0tg.png" alt="Fundamental epidemiological indicators. A) Top: mean \(R(t)\) of data-driven model (solid line) compared to the solution under a completely homogeneous population (dashed line). The colored area shows the density distribution of \(R(t)\) values obtained in single realizations of the model. Bottom: the reproductive number is broken down in the four layers. B) As A but for the generation time. In all cases the simulations have been aligned at the peak of the epidemic." width="456" />
<p class="caption">
Figure 3.7: <strong>Fundamental epidemiological indicators.</strong> A) Top: mean <span class="math inline">\(R(t)\)</span> of data-driven model (solid line) compared to the solution under a completely homogeneous population (dashed line). The colored area shows the density distribution of <span class="math inline">\(R(t)\)</span> values obtained in single realizations of the model. Bottom: the reproductive number is broken down in the four layers. B) As A but for the generation time. In all cases the simulations have been aligned at the peak of the epidemic.
</p>
</div>

<p>We find that <span class="math inline">\(R(t)\)</span> increases over time in the early phase of the epidemic, starting from <span class="math inline">\(R_0 = 1.3\)</span> to a peak of about <span class="math inline">\(2.5\)</span> (figure <a href="chap-chap3.html#fig:chap3-r0-r0tg">3.7</a>A). In contrast, in the homogeneous model (dashed line), which lacks the typical structures of human populations, <span class="math inline">\(R(t)\)</span> is nearly constant in the early epidemic phase and then rapidly declines before the epidemic peak (<span class="math inline">\(t=0\)</span>), as predicted by the classical theory. The non-constant phase of <span class="math inline">\(R(t)\)</span> implies that <span class="math inline">\(R_0\)</span> loses its meaning as a fundamental indicator in favor of <span class="math inline">\(R(t)\)</span>. In figure <a href="chap-chap3.html#fig:chap3-r0-r0tg">3.7</a>B we show an analogous analysis of the measured generation time in the data-driven model. In this case, we find that <span class="math inline">\(Tg\)</span> is considerably shorter than the infectious period (<span class="math inline">\(3\)</span> days), with a more marked shortening near the epidemic peak. Once again, in the homogeneous model (dashed line) the behavior predicted by the classical theory is recovered.</p>
<p>A closer look at the transmission process in each layer helps to understand the origin of the deviations from classical theory. Specifically, we see that <span class="math inline">\(R(t)\)</span> tends to peak in the workplace layer, and to some extent also in the school layer. In the community layer, on the other hand, the behavior is much closer to what is expected in a classical homogeneous population. We also find that <span class="math inline">\(Tg\)</span> is remarkably shorter in the household layer than in all other layers. This could simply be due to a depletion of susceptibles. To illustrate this, suppose that an infected individual in a household of size 3 infected one of the other two. Then, during the next time step both will compete to infect the last susceptible, something that does not happen in large populations. This would lead to a shorter generation time simply because she is unable to infect other members, even if she is still infected. This evidence calls for considering within household competition effects when analyzing empirical data of the generation time.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-r0-attack"></span>
<img src="images/Fig_chap3_r0_attack.png" alt="Attack rate as a function of site size. A) Fraction of individuals belonging to each place that contracted the disease, not necessarily in said setting. B) Solid line: average size of places in which there is at least one new infection in each time step, broken down in three layers. Dashed line: expected size if there is at least one infection in every place." width="404" />
<p class="caption">
Figure 3.8: <strong>Attack rate as a function of site size.</strong> A) Fraction of individuals belonging to each place that contracted the disease, not necessarily in said setting. B) Solid line: average size of places in which there is at least one new infection in each time step, broken down in three layers. Dashed line: expected size if there is at least one infection in every place.
</p>
</div>

<p>To further understand the reasons of the diverse trends observed in each layer, in figure <a href="chap-chap3.html#fig:chap3-r0-attack">3.8</a> we analyze the effect that the size of the components has on the dynamics. In figure <a href="chap-chap3.html#fig:chap3-r0-attack">3.8</a>A we study the attack rate (final fraction of removed individuals, i.e., individuals that suffered the infection at some point) as a function of the site size, distinguishing the three layers. The results indicate that the spreading is much more important in large buildings, but we know that they are scarce (see figure <a href="chap-chap3.html#fig:chap3-r0-scheme">3.6</a>B). Hence, it seems that the initial growth of the epidemic might stop once the big components have been mostly infected. This is corroborated in figure <a href="chap-chap3.html#fig:chap3-r0-attack">3.8</a>B, where the average size of buildings with at least one infection is shown. The situation is thus clear. In the classical model not only it is assumed that all population is initially susceptible, but also that it is in contact with the first infected since the beginning. In heterogeneous populations, however, the first infected individual has only a handful of local contacts, diminishing its infectious power. Then, as the epidemic progresses more and more susceptibles enter into play, increasing the amount of individuals that can be infected. Yet, sooner or later the components will run out of susceptibles, even if there is still a large fraction available in the rest of the system. This, in turn, leads to a more abrupt descent than what is expected in the classical approximation.</p>
<p>These results clearly highlight how the heterogeneity of human interactions (i.e., clustering in households, schools and workplaces) alters the standard results of fundamental epidemiological indicators, such as the reproduction number and the generation time. Furthermore, they call into question the measurability of <span class="math inline">\(R_0\)</span> in realistic populations, as well as its adequacy as an approximate descriptor of the epidemic dynamics. Lastly, our study suggests that epidemic inflection points, often ascribed to behavioral changes or control strategies, could also be explained by the natural contact structure of the population. Hopefully, this analysis will open the path to developing better theoretical frameworks, in which some of the most fundamental assumptions of epidemiology have to be revisited.</p>
</div>
</div>
<div id="sec:chap3-directed" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> The epidemic threshold fades out</h2>
<p>In epidemiology attention has historically been restricted to biological factors. We began this chapter stating that individuals were just indistinguishable particles interacting according to the mass action law. However, throughout the following sections, we have shown that when this oversimplification is relaxed many interesting phenomena arise. In this section we shall go one step further and completely remove what we called assumptions 3 and 4: mass action and indistinguishability. To distinguish individuals, we will assign to each of them an index, <span class="math inline">\(i\)</span>. Then, we will allow individuals to spread the disease only to those with whom they have some kind of contact (e.g. they are friends), which we will encode in links. In other words, we are finally going to introduce networks into the picture.</p>
<p>It is rather difficult to establish the origin of what we may call disease spreading on networks or network epidemiology. Probably, one of the earliest attempts is the work by Cochran, in 1936 <span class="citation">[<a href="references.html#ref-Cochran1936" role="doc-biblioref">221</a>]</span>, in which he studied the propagation of a disease in a small plantation of tomatoes. Although his work might be better described as statistical analysis, the reason to consider it one of the precursors of the spreading on networks is that, as Kermack and McKendrick had done roughly 10 years before, his assumptions were all mechanistic rather than based on the knowledge of the particular problem. This is clearly seen in how he introduced the model: <em>“We suppose that in the first [day] each plant in the field has an equal and independent chance <span class="math inline">\(p\)</span> of becoming infected, and that in the second [day] a plant which is next to a diseased plant has a probability <span class="math inline">\(s\)</span> of being infected by it, healthy plants which are not next to a diseased plant remaining healthy”</em>. In modern terminology, the plants were arranged in a <em>lattice</em> structure and could infect their first neighbors with probability <span class="math inline">\(s\)</span>. The assumptions are particularly strong because he knew that the disease was propagated by an insect, but decided to create a very general model.</p>
<p>During the next couple of decades, lattice systems were quite popular in physics, geography and ecology. Then, in the 1960s the interest in studying the spatial spread of epidemics started to grow (see the introduction of <span class="citation">[<a href="references.html#ref-Morris1993Aug" role="doc-biblioref">222</a>]</span> for a nice overview) with three main approaches. In the first, the agents that could be infected were set in the center of a certain tessellation of space and could only infect/be infected by their neighbors. This is the closest approach to the modern study of epidemics on networks, but it was not so popular as it was mainly used to study plant systems <span class="citation">[<a href="references.html#ref-Dietz1967" role="doc-biblioref">223</a>]</span>. The most popular approach was to distribute individuals continuously in space with some chosen density. This led to the study of diffusion processes, focusing on the interplay between velocity and density <span class="citation">[<a href="references.html#ref-Mollison1977" role="doc-biblioref">224</a>]</span>. The third approach was based on what we briefly defined in section <a href="chap-chap3.html#subsec:chap3-homo-age">3.1.1</a> as metapopulations. Recall that in a metapopulation individuals are arranged in a set of sub-populations. Within each sub-population usually homogeneous mixing is applied and it is also allowed to have individuals migrating from one sub-population to another. Hence, the idea was to simulate the fact that people (or animals) live in a certain place where they can contract the disease, and then travel to a different area and spread it to its inhabitants <span class="citation">[<a href="references.html#ref-bailey1975" role="doc-biblioref">168</a>]</span>. Note, however, that in none of these methods we are taking into account any sociological factors of the population.</p>
<p>In the beginning of the 1980s some results pointing into the direction of introducing more complex networks started to appear. In particular, von Bahr and Martin-L"{o}f in 1980 <span class="citation">[<a href="references.html#ref-VonBahr1980Jun" role="doc-biblioref">225</a>]</span> and Grassberger in 1983 <span class="citation">[<a href="references.html#ref-Grassberger1983Apr" role="doc-biblioref">226</a>]</span> (in the context of percolation) showed that the classical SIR model on a homogeneous population could be related to the ER graph model that we saw in section <a href="chap-chap2.html#subsec:chap2-graphs-degdist">2.1.2</a>. Indeed, suppose that we have a set of individuals under the homogeneous mixing approach and simulate an epidemic. Next, if an individual <span class="math inline">\(i\)</span> infects another individual <span class="math inline">\(j\)</span>, we establish a link between them. If the probability of this event is really low, the epidemic will not take place. Conversely, for large probabilities most nodes will be randomly connected. This is precisely how we defined the ER model, with the only difference being that the probability <span class="math inline">\(p\)</span> of establishing a link will be a function of both the probability of infecting someone, <span class="math inline">\(\beta\)</span>, and that of getting recovered, <span class="math inline">\(\mu\)</span>. Note, however, that they did not implement a disease dynamics on a network, but rather extracted the network from the results of the dynamics.</p>
<p>Roughly at the same time, the gonorrhea rates rose precipitously. To understand the dynamics of this venereal disease, it was recognized that some sort of nonrandom mixing of the population had to be incorporated to the models. The first attempts were based on separating the contact process and the spreading process <span class="citation">[<a href="references.html#ref-Bailey1979Oct" role="doc-biblioref">227</a>]</span>. Indeed, going back to the definition of the SIR model, we defined the rate of infectivity <a href="chap-chap3.html#eq:chap3-homo-A2">(3.5)</a> as <span class="math inline">\(\phi(\tau) = \beta/N\)</span> (under the frequency approach). We can simply define $= c ’ $ where <span class="math inline">\(c\)</span> is the contact rate between individuals and <span class="math inline">\(\beta &#39;\)</span> the probability of spreading the disease given that a contact has taken place. For simplicity, we can remove the apostrophe and simply write <span class="math inline">\(\phi(\tau) = c \beta/N\)</span>. With this definition the epidemic threshold would read</p>
<p><span class="math display" id="eq:chap3-directed-th1">\[\begin{equation}
\frac{c \beta}{\mu} &gt; 1 \Rightarrow \frac{\beta}{\mu} &gt; \frac{1}{c}\,.
\tag{3.53}
\end{equation}\]</span></p>
<p>This expression is giving us a very powerful insight about how to combat diseases. Supposing that <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\mu\)</span> are fixed, as they mostly depend on the characteristics of the pathogen, the best way to prevent and epidemic is to reduce the number of contacts as much as possible. A similar result was obtained in the context of vector-borne diseases, in which the number of vectors (e.g. mosquitoes) play the role of the number of contacts <span class="citation">[<a href="references.html#ref-Dietz1980" role="doc-biblioref">228</a>]</span>.</p>
<p>The next step was the introduction of mixing matrices, the same approach that we followed to incorporate age into the SIR model in section <a href="chap-chap3.html#subsec:chap3-homo-age">3.1.1</a>. Recall that the idea was to divide the population into smaller groups according to some characteristics (e.g. gender or age) and establish some rules governing the interaction between those groups encoded in a contact matrix (hence the name of mixing matrices). Typically, both the group definitions and the mixing function were very simple. In the context of venereal diseases, the most common characteristic used to form groups was activity level. This approach was popularized by Hethcote and Yorke in 1984 <span class="citation">[<a href="references.html#ref-Hethcote1984" role="doc-biblioref">229</a>]</span> in their modeling of gonorrhea dynamics using the core group: a group of highly sexually active individuals who are efficient transmitters interacted with a much larger noncore group. They showed that with less than 2% of the population in the core group, this model lead to 60% of the infections to be caused directly by core members. Yet, the world of epidemiology was about to be shaken by a new virus that would defy all these assumptions, HIV.</p>
<div id="subsec:chap3-directed-decade" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> The decade of viruses</h3>
<p>The emergence of HIV in the early 1980s forced scientists to pay even more attention to the role of selective mixing. In 1986, in one of the earliest attempts to model this disease <span class="citation">[<a href="references.html#ref-Anderson1986" role="doc-biblioref">230</a>]</span>, Anderson and May summarized the challenges that sexually transmitted diseases (STDs) presented in contrast to other more common infectious diseases such as measles:</p>
<ol style="list-style-type: decimal">
<li><p>For STDs only sexually active individuals need to be considered as candidates of the transmission process, in contrast to simple “mass action” transmission models.</p></li>
<li><p>The carrier phenomenon, in which certain individuals harbor asymptomatic infection, is important for many STDs.</p></li>
<li><p>Many STDs induce little or no acquired immunity. In the case of HIV, the situation is probably more complex since persistence without symptoms might be lifelong.</p></li>
<li><p>The transmission of most STDs is characterized by a high degree of heterogeneity generated by great variability in sexual habits among individuals within a given community.</p></li>
</ol>
<p>They concluded their introduction with a sentence that we would like to highlight, although its full meaning will not be understood until the end of this section: “This set of characteristics - <em>virtual absence of a threshold density of hosts for disease-agent persistence</em>, long-lived carriers of infection, absence of lasting immunity, and a great heterogeneity in transmission - give rise to infectious diseases that are well adapted to persist in small low-density aggregations of people”.</p>
<p>Clearly, the homogeneous mixing approach was not valid anymore and heterogeneity had to enter into play. However, there was a huge problem, they did not have any data. Up to that point, epidemiologists had focused on the biological factors of diseases, completely ignoring the heterogeneity of human interactions. Yet, the importance that they had in HIV transmission sprouted a series of studies that would finally shed some light in the contact patterns of human populations. In particular, during the first years of the HIV epidemic, it was observed that homosexual males accounted for 70-80% of the known cases, and thus most efforts were devoted to study said community. The earliest studies found that the distribution of the number of sexual partners had a high mean, but also a very large variance<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>.</p>
<p>This observation led them to the formulation of a model that could account for this huge heterogeneity (a variance much larger than the mean). They focused on a closed population of homosexual males and divided it into sub-groups of size <span class="math inline">\(N_i\)</span>, whose members on average had <span class="math inline">\(i\)</span> new sexual partners per unit time. Under these assumptions, the SIR model reads</p>
<p><span class="math display" id="eq:chap3-directed-maySIR">\[\begin{equation}
\left\{\begin{array}{l}
\dv{S_i(t)}{t}  = - i \lambda S_i \\
\dv{I_i(t)}{t}  = i \lambda S_i - \mu I_i \\
\dv{R_i(t)}{t}  = \mu I_i(t)
\end{array}\right.\,,
\tag{3.54}
\end{equation}\]</span></p>
<p>where the infection probability per partner, <span class="math inline">\(\lambda\)</span>, was given by</p>
<p><span class="math display" id="eq:chap3-directed-maySIR2">\[\begin{equation}
\lambda = \beta \frac{\sum_i i I_i}{\sum i N_i}\,.
\tag{3.55}
\end{equation}\]</span></p>
<p>At first glance it might seem that the model has not changed that much, as it is just the standard SIR model with <span class="math inline">\(i\)</span> contacts. However, considering that the population is divided into several groups with heterogeneous contact patterns leads to a result that 15 years latter would become one of the cornerstones of network science. According to Anderson and May, in this model the early rate of exponential growth, <span class="math inline">\(\Lambda\)</span>, is defined as</p>
<p><span class="math display" id="eq:chap3-directed-early">\[\begin{equation}
\Lambda = \beta \frac{\langle i^2 \rangle}{\langle i \rangle} - \mu\,.
\tag{3.56}
\end{equation}\]</span></p>
<p>Hence, the epidemic only grows if</p>
<p><span class="math display" id="eq:chap3-directed-th2">\[\begin{equation}
\frac{\beta}{\mu} &gt; \frac{\langle i \rangle}{\langle i^2\rangle}\,,
\tag{3.57}
\end{equation}\]</span></p>
<p>which we can arrange to look like equation <a href="chap-chap3.html#eq:chap3-directed-th1">(3.53)</a>,</p>
<p><span class="math display" id="eq:chap3-directed-th3">\[\begin{equation}
\frac{\beta}{\mu} &gt; \frac{1}{c&#39;} ~~~\text{ with  } c&#39; = \frac{\langle i^2\rangle}{\langle i \rangle}\,.
\tag{3.58}
\end{equation}\]</span></p>
<p>Thus, for epidemiological purposes, the effective value of the average number of new partners per unit time is not the mean of the distribution, but rather it is the ratio of the mean square to the mean. In other words, this result reflects the disproportionate role played by individuals in the most active groups, who are both more likely to acquire infection and more likely to spread it <span class="citation">[<a href="references.html#ref-May1988" role="doc-biblioref">231</a>]</span>.</p>
<p>In parallel, Boltz, Blancard and Kr"{u}ger started to develop in 1986 a series of complex computational models that allowed them to introduce many more factors into the dynamics <span class="citation">[<a href="references.html#ref-boltz1988" role="doc-biblioref">232</a>]</span>. They said that the principal weaknesses of the standard epidemiological models when applied to HIV infection were:</p>
<ul>
<li><p>They describe, through mass action dynamics, permanent potential contact between all members of the groups involved.</p></li>
<li><p>The behavior is uniform over each group. To account for nonuniform behavior, a subdivision into sub-groups has to be done at the prize of a higher dimensionality of the systems of differential equations.</p></li>
<li><p>They cannot directly take into account partners.</p></li>
<li><p>Time delays, age dependencies and time dependent rates are not easily incorporated.</p></li>
<li><p>They do not represent the true contact structure of the population.</p></li>
</ul>
<p>Hence, they proposed to use <em>“random graphs and discrete time stochastic processes to model the epidemic dynamics of sexually transmitted diseases”</em>. This is one of the earliest (if not the first) attempts to clearly study disease dynamics on networks.</p>
<p>Their models were highly detailed. For instance, they considered eleven groups of individuals: homosexual males, bisexual males, heterosexual males, heterosexual females, heterosexual females having contact with bisexual males, male intravenous drugs users, female intravenous drug users, prostitutes, prostitutes who are also intravenous drug users and hemophiliacs (clearly way beyond the simple model of only homosexuals that was being studied analytically in those days). Even more, they could track the behavior of single individuals. But this level of detail also posed the problem of acquiring a huge amount of data to parameterize the models that, admittedly, they did not have at that time. In any case, this represented a huge step forward in the direction of highly detailed computational models, as the one we presented in section <a href="chap-chap3.html#subsec:chap3-r0-pnas">3.2.3</a>.</p>
<p>Yet, data was about to arrive. Already in 1985 Klovdahl <span class="citation">[<a href="references.html#ref-Klovdahl1985Jan" role="doc-biblioref">233</a>]</span>, inspired by the networks that sociologist had been studying since the 1930s, studied the information provided by a small sample of 40 patients with AIDS and reconstructed their social network. He proposed that a “network approach” could be a key element to understand the nature and spread of the disease. Some years later, in 1994 <span class="citation">[<a href="references.html#ref-Klovdahl1994Jan" role="doc-biblioref">234</a>]</span>, together with some collaborators, he designed a larger experiment to obtain the social network of a small city in Colorado. Their approach was to initially target individuals with higher risk of contracting HIV, such as prostitute women and injecting drug users, and trace as many contacts (of any kind) as they could. Their results showed that a lot of people were much closer to HIV infection than expected, implying that a small change (e.g. reducing condom use) could quickly reach individuals who were not directly connected with people infected with HIV. To demonstrate the importance of a network perspective in epidemiology they gave a very simple example: suppose that one individual is infected with HIV and reports sexual relationships with two people and a social relation with another one. Commonly, health professionals would only worry about the first two, disregarding the latter. However, if that third individual happens to by highly <em>central</em> in the network (i.e., having a large degree or betweenness, using the terminology of chapter <a href="chap-chap2.html#chap:chap2">2</a>), an eventual infection could lead to an “explosion” of disease. Hence, their claim was that under a network perspective addressing the distance to the disease and the centrality of individuals was as important as being actually infected with HIV.</p>
<p>Clearly the concept of networks was starting to gain momentum in epidemiology, although it was not always clear what was part of the epidemic model and which elements came just from the topology of the network (see <span class="citation">[<a href="references.html#ref-Watts1998" role="doc-biblioref">56</a>]</span> and the references therein). A noteworthy exception is the work by Andersson in 1997 <span class="citation">[<a href="references.html#ref-Andersson1997Mar" role="doc-biblioref">235</a>]</span> in which he studied an epidemic process on a random graph, this time from an analytical point of view, and concluded that the basic reproduction number was</p>
<p><span class="math display" id="eq:chap3-directed-R097">\[\begin{equation}
R_0 = p_1 \left(\frac{\langle X^2 \rangle}{\langle X \rangle} -1\right)\,,
\tag{3.59}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(X\)</span> denotes the number of links a certain node has. Thus, there is a clear dependency on the topology of the networks, regardless its specific shape. The similarity with the expression that Anderson and May obtained 10 years before is clear (equation <a href="chap-chap3.html#eq:chap3-directed-th2">(3.57)</a>), the only difference is the <span class="math inline">\(-1\)</span> factor (and the fact that he set <span class="math inline">\(\mu=1\)</span>). The reasons why these two expressions are so similar, and why this expression contains a <span class="math inline">\(-1\)</span> will come clear in a moment. But first, we need to go back in time a little bit to have a look at what was happening in the emerging field of <em>cybersecurity</em>.</p>
<p>On November 3, 1983, the first computer virus was conceived as an experiment to be presented at a weekly seminar on computer security. A virus, in this context, is a computer program that can “infect” other programs by modifying them to include a possibly evolved copy of itself. Thus, if the programs communicate with other computers, the viruses can spread through the whole network. During this decade, the internet started to grow, connecting more and more computers through a huge network. Hence, viruses imposed a clear threat <span class="citation">[<a href="references.html#ref-Cohen1987Feb" role="doc-biblioref">236</a>]</span>. Soon after, in 1988, Murray proposed that the propagation of computer viruses could be studied using epidemiology tools<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> <span class="citation">[<a href="references.html#ref-Murray1988Apr" role="doc-biblioref">237</a>]</span>. Then, in 1991, Kephart and White tried to apply epidemic models to study the propagation of viruses, but quickly realized that the homogeneous mixing approach was not suited for computers, as they were connected through networks <span class="citation">[<a href="references.html#ref-Kephart1991May" role="doc-biblioref">238</a>]</span>. Hence, they applied the model on a random directed graph and showed that the probability of having an epidemic depended on the connectivity of the network. When connectivity was high, they recovered the classical results of Kermack and McKendrick obtained under the homogeneous mixing approach. Conversely, when connectivity was really low the probability quickly decreased. However, they were unable to mathematically show this and had to rely on simulations (we can hypothesize that if they had been aware of the results found for venereal diseases they might had been able to do it, because their observation is essentially explained by equation <a href="chap-chap3.html#eq:chap3-directed-th1">(3.53)</a>, but it seems highly unlikely that computer scientists were interested in such a specific sub-field back then). Yet, there was something odd. During the 1990s Kephart and collaborators collected virus statistics from a population of several hundred thousand PCs. They observed that there was a huge amount of viruses that survived for a really long time, but also that their spreading was quite low and reached only a small fraction of the population, contrary to the expected exponential growth predicted by epidemiology (see section <a href="chap-chap3.html#subsec:chap3-r0-measure">3.2.1</a>) <span class="citation">[<a href="references.html#ref-Kephart1997Nov" role="doc-biblioref">239</a>]</span>. The only possibility, according to the theory, was that the infection and recovery parameters associated with each virus were really close to the epidemic threshold, yielding low growth but still some persistence. Yet, this regularity seemed highly unlikely and they advocated to further account the network patterns as possible reasons behind this discrepancy.</p>
<p>With this context, we will now finally be able to realize why disease dynamics has been one of the main areas of research in network science and, at the same time, why networks became so successful in a relatively short period of time. In 1999 Albert et al. measured the topology of the World Wide Web, considering each document as a node and their hyperlinks to other documents as links. Surprisingly, the degree distribution of such network did not follow the Poisson distribution of random graphs but rather a power law distribution <span class="citation">[<a href="references.html#ref-Albert1999Sep" role="doc-biblioref">240</a>]</span>. In section <a href="chap-chap2.html#subsec:chap2-graphs-degdist">2.1.2</a> we defined scale-free networks as those networks whose degree distribution followed a power law. Moreover, we showed that if the exponent of the distribution is in the interval <span class="math inline">\(\gamma \in (2,3)\)</span>, the average of the distribution is finite but the second moment of the distribution diverges if the system size tends to infinity.</p>
<p>In 2001 Pastor-Satorras and Vespignani studied the behavior of an SIS model on a network, in an attempt to answer the questions posed by Kephart <span class="citation">[<a href="references.html#ref-Pastor-Satorras2001Apr" role="doc-biblioref">241</a>]</span>. The SIS model, which we have not talked about yet, is simply the SIR model but once an individual is cured instead of going into the removed compartment she is sent back to the susceptible one. Hence, the equation describing the process is</p>
<p><span class="math display" id="eq:chap3-directed-SIS">\[\begin{equation}
\frac{\text{d}I(t)}{\text{d}t} = \frac{\beta}{N} S(t) I(t) - \mu I(t)\,,
\tag{3.60}
\end{equation}\]</span></p>
<p>with <span class="math inline">\(S(t) + I(t) = N\)</span>. However, as they wanted to apply it on a network they had to keep track of the state of each node, yielding a system of <span class="math inline">\(N\)</span> coupled equations,</p>
<p><span class="math display" id="eq:chap3-directed-SIS2">\[\begin{equation}
\frac{\text{d}p_i(t)}{\text{d}t} = \beta [1-p_i(t)] \sum_j a_{ij}p_j(t)  - \mu p_i(t)\,,
\tag{3.61}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(p_i(t)\)</span> denotes the probability that node <span class="math inline">\(i\)</span> is infected at time <span class="math inline">\(t\)</span>. This system does not have a closed form solution and, besides, it depends on the adjacency matrix of the network (the term <span class="math inline">\(a_{ij}\)</span>). Hence, they followed a mean-field approach and supposed that the behavior of nodes with the same degree <span class="math inline">\(k\)</span> would be similar. Under this assumption, the system is reduced to</p>
<p><span class="math display" id="eq:chap3-directed-SIS3">\[\begin{equation}
\frac{\text{d}\rho_k(t)}{\text{d}t} = \beta [1-\rho_k(t)] k \Theta - \mu \rho_k(t)\,,
\tag{3.62}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\rho_k\)</span> is the density of infected individuals with degree <span class="math inline">\(k\)</span> and <span class="math inline">\(\Theta\)</span> is the probability that any given link points to an infected node.</p>
<p>The stationary solution (i.e. <span class="math inline">\(d_t \rho_k(t) = 0\)</span>) yields</p>
<p><span class="math display" id="eq:chap3-directed-SIS4">\[\begin{equation}
\rho_k = \frac{k \beta \Theta}{\mu+k\beta \Theta}\,,
\tag{3.63}
\end{equation}\]</span></p>
<p>denoting that the higher the node connectivity, the higher the probability to be infected. Now, in the absence of correlations the probability that a randomly chosen link in the network is attached to a node with <span class="math inline">\(s\)</span> links is proportional to <span class="math inline">\(sP(s)\)</span>, where <span class="math inline">\(P(s)\)</span> denotes the probability of having degree <span class="math inline">\(s\)</span>. Hence,</p>
<p><span class="math display" id="eq:chap3-directed-SIS5">\[\begin{equation}
\Theta = \sum_k \frac{k P(k) \rho_k}{\sum_s s P(s)}\,.
\tag{3.64}
\end{equation}\]</span></p>
<p>Combining <a href="chap-chap3.html#eq:chap3-directed-SIS4">(3.63)</a> and <a href="chap-chap3.html#eq:chap3-directed-SIS5">(3.64)</a>,</p>
<p><span class="math display" id="eq:chap3-directed-SIS6">\[\begin{equation}
\Theta = \sum_k \frac{k P(k)}{\sum_s s P(s)} \cdot \frac{ k \beta \Theta}{\mu+k\beta \Theta}\,.
\tag{3.65}
\end{equation}\]</span></p>
<p>Besides the trivial solution <span class="math inline">\(\rho_k=0\)</span>, <span class="math inline">\(\rho_k&gt;0\)</span> will be a solution of the system as long as</p>
<p><span class="math display" id="eq:chap3-directed-SIS7">\[\begin{equation}
\frac{\beta}{\mu} \frac{\langle k^2\rangle}{\langle k \rangle} &gt; 1\,,
\tag{3.66}
\end{equation}\]</span></p>
<p>which can be identified as the basic reproduction number of the system. Better still, we can put all parameters relating to the disease in one side and all the ones coming from the network in the other so that</p>
<p><span class="math display" id="eq:chap3-directed-SIS8">\[\begin{equation}
R_0 = \frac{\beta}{\mu} &gt; \frac{\langle k \rangle}{\langle k^2\rangle}\,.
\tag{3.67}
\end{equation}\]</span></p>
<p>Hence, the epidemic threshold is not 1 anymore. Instead, it is a function of the connectivity of the network. But remember that the pourpose of the model was to study disease propagation on computer networks which, according to Albert et al., were not only scale-free but also had an exponent of <span class="math inline">\(\gamma = 2.45\)</span> <span class="citation">[<a href="references.html#ref-Albert1999Sep" role="doc-biblioref">240</a>]</span>. Thus, in the internet <span class="math inline">\(\langle k^2 \rangle \rightarrow \infty\)</span>, implying that equation <a href="chap-chap3.html#eq:chap3-directed-SIS8">(3.67)</a> is actually</p>
<p><span class="math display" id="eq:chap3-directed-SIS9">\[\begin{equation}
R_0 &gt; \frac{\langle k \rangle}{\langle k^2 \rangle} \rightarrow 0\,.
\tag{3.68}
\end{equation}\]</span></p>
<p>In other words, the epidemic threshold fades out. Moreover, two months later Liljeros et al. showed that the network of human sexual contacts was also scale free <span class="citation">[<a href="references.html#ref-Liljeros2001Jun" role="doc-biblioref">242</a>]</span>.</p>
<p>This result is the answer to all the questions that have arisen throughout this section. First, it explains why so many computer viruses were able to persist without growing exponentially. Indeed, if the epidemic threshold had been 1 then they all had to be really close to 1. However, as it tends to 0, they can be anywhere between 0 and 1, be able to infect a macroscopic fraction of the population and at the same time doing it slowly. It is also worth highlighting that from very different approaches Anderson and May obtained essentially the same result <a href="chap-chap3.html#eq:chap3-directed-th2">(3.57)</a>. The reason is simply that in the mean-field approximation we have neglected the connections and only considered groups of nodes with <span class="math inline">\(k\)</span> neighbors, which is equivalent to Anderson and May groups of individuals making <span class="math inline">\(i\)</span> new sexual partners per unit time. Even more, if we add the fact that the network of sexual contacts is scale free, we finally understand the reason behind the <em>virtual absence of a threshold</em> they were talking about in the 1980s. Furthermore, this result refutes the hypothesis of the core-noncore gonorrhea model. In order to have two distinct groups, the sexual contact network should have a binomial degree distribution, but it does not. Nevertheless, the idea was not completely wrong as the role of the core is played by the nodes with large degree, the <em>hubs</em> of the network.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-redes-comparison"></span>
<img src="images/Fig_chap3_redes_comparison.png" alt="Epidemic threshold and topology. Total fraction of recovered individuals in equilibrium conditions as a function of \(\beta/\mu\). In the homogeneous mixing approach the epidemic threshold is 1. When the SIR model is implemented in a random network with \(\langle k \rangle = 3\) the epidemic threshold is \(1/3\) (3.71). Conversely, in a SF network with \(\langle k \rangle = 3\) and \(\langle k^2 \rangle = 113\) the epidemic threshold is \(0.03\). Note that the size of the network is \(N=10^4\), with a maximum degree of \(k_\text{max} = \sqrt{N}\) to avoid correlations (see chapter 2). Hence, the threshold does not vanish completely, as it is supposed to be 0 only the limit of \(N\rightarrow \infty\)." width="433" />
<p class="caption">
Figure 3.9: <strong>Epidemic threshold and topology.</strong> Total fraction of recovered individuals in equilibrium conditions as a function of <span class="math inline">\(\beta/\mu\)</span>. In the homogeneous mixing approach the epidemic threshold is 1. When the SIR model is implemented in a random network with <span class="math inline">\(\langle k \rangle = 3\)</span> the epidemic threshold is <span class="math inline">\(1/3\)</span> <a href="chap-chap3.html#eq:chap3-directed-thSIR">(3.71)</a>. Conversely, in a SF network with <span class="math inline">\(\langle k \rangle = 3\)</span> and <span class="math inline">\(\langle k^2 \rangle = 113\)</span> the epidemic threshold is <span class="math inline">\(0.03\)</span>. Note that the size of the network is <span class="math inline">\(N=10^4\)</span>, with a maximum degree of <span class="math inline">\(k_\text{max} = \sqrt{N}\)</span> to avoid correlations (see chapter <a href="chap-chap2.html#chap:chap2">2</a>). Hence, the threshold does not vanish completely, as it is supposed to be 0 only the limit of <span class="math inline">\(N\rightarrow \infty\)</span>.
</p>
</div>

<p>Furthermore, note that to obtain expression <a href="chap-chap3.html#eq:chap3-directed-SIS8">(3.67)</a> the only property of the network that we have used is that it is uncorrelated. Whence, it can be used to study any network that we desire. In particular, in the case of random graphs the degree distribution is Poisson, implying that <span class="math inline">\(\langle k^2 \rangle = \langle k \rangle^2 + \langle k \rangle\)</span>. Thus, for those networks the epidemic threshold is simplified to</p>
<p><span class="math display" id="eq:chap3-directed-ER">\[\begin{equation}
R_0 = \frac{\beta}{\mu} &gt; \frac{1}{\langle k \rangle + 1}\,,
\tag{3.69}
\end{equation}\]</span></p>
<p>which is the result obtained by the earliest studies of gonorrhea propagation <a href="chap-chap3.html#eq:chap3-directed-th1">(3.53)</a> (except for the <span class="math inline">\(+1\)</span>, but its role will be elucidated in a moment). In other words, we can say that the problem in those models is that they implicitly assumed a random contact network when they should have used a scale free network instead. In figure <a href="chap-chap3.html#fig:chap3-redes-comparison">3.9</a> we show a comparison of the final size of the epidemic as a function of <span class="math inline">\(R_0\)</span> between ER networks, SF networks and the homogeneous mixing approach.</p>
<p>Note that most of the ideas had been around for years, but did not get that much attention. We could argue that what really made the difference in the case of the work by Pastor-Satorras and Vespignani was the use of data. Indeed, many theoretical approaches can be proposed, but without experimental data it is not possible to really gauge their importance. Thus, once again, this highlights how incorporating more data into already existing models can make the difference.</p>
<p>To conclude, we should address why the equation obtained by Anderson and May for the SIR model did not have a <span class="math inline">\(-1\)</span> factor <a href="chap-chap3.html#eq:chap3-directed-th2">(3.57)</a>, the one from Andersson also for the SIR model did <a href="chap-chap3.html#eq:chap3-directed-R097">(3.59)</a> and the one from Pastor-Satorras and Vespignani for the SIS model did not <a href="chap-chap3.html#eq:chap3-directed-SIS8">(3.67)</a>. The first observation is that in the SIS model on a network, it is possible that if <span class="math inline">\(i\)</span> infects <span class="math inline">\(j\)</span>, then <span class="math inline">\(i\)</span> recovers and <span class="math inline">\(j\)</span> infects <span class="math inline">\(i\)</span>. This cannot happen in the SIR model, so for a node of degree <span class="math inline">\(k\)</span> only <span class="math inline">\(k-1\)</span> links can transmit the disease,</p>
<p><span class="math display" id="eq:chap3-directed-thetaSIR">\[\begin{equation}
\Theta = \sum_k \frac{(k-1)P(k)\rho_k}{\sum_s s P(s)}\,,
\tag{3.70}
\end{equation}\]</span></p>
<p>leading to the threshold <span class="citation">[<a href="references.html#ref-Dorogovtsev2008Oct" role="doc-biblioref">243</a>]</span></p>
<p><span class="math display" id="eq:chap3-directed-thSIR">\[\begin{equation}
R_0^\text{SIR} &gt; \frac{\langle k \rangle}{\langle k^2\rangle - \langle k \rangle}\,.
\tag{3.71}
\end{equation}\]</span></p>
<p>Which explains the discrepancy between <a href="chap-chap3.html#eq:chap3-directed-R097">(3.59)</a> and <a href="chap-chap3.html#eq:chap3-directed-SIS8">(3.67)</a>. Lastly, note that in the case of Anderson and May they did not consider a fixed structure, such as a network, but rather that at each time step every individual would seek <span class="math inline">\(i\)</span> new sexual partners. Thus, the correction accounting where the disease came from does not apply to their model.</p>
</div>
<div id="subsec:chap3-directed-generating" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> The generating function approach</h3>
<p>There are multiple techniques that can be used to solve the system <a href="chap-chap3.html#eq:chap3-directed-SIS2">(3.61)</a> and obtain the value of the epidemic threshold (see <span class="citation">[<a href="references.html#ref-Pastor-Satorras2015Aug" role="doc-biblioref">145</a>], [<a href="references.html#ref-Dorogovtsev2008Oct" role="doc-biblioref">243</a>]</span> for a review). In this section we will describe an approach introduced by Newman in 2002 inspired by percolation <span class="citation">[<a href="references.html#ref-Newman2002Jul" role="doc-biblioref">244</a>]</span>, based on the use of generating functions, that is specially suited to analyze directed networks. This is the methodology that we will use in section <a href="chap-chap3.html#subsec:chap3-directed-multilayer">3.3.3</a> to study disease propagation in directed multiplex networks.</p>
<p>Although for the moment we are only interested in undirected networks, we will introduce the methodology considering that the networks might have both directed and undirected links <span class="citation">[<a href="references.html#ref-Meyers2006Jun" role="doc-biblioref">245</a>]</span>, as this will be the approach used in section <a href="chap-chap3.html#subsec:chap3-directed-multilayer">3.3.3</a>. Hence, suppose that the probability that a random node of the network has <span class="math inline">\(j\)</span> incoming links, <span class="math inline">\(l\)</span> outgoing links and <span class="math inline">\(m\)</span> undirected links is <span class="math inline">\(p_{jlm}\)</span>. The generating function of the distribution will be</p>
<p><span class="math display" id="eq:chap3-directed-G">\[\begin{equation}
G(x,y,z) = \sum_{j=0}^\infty \sum_{l=0}^\infty \sum_{m=0}^\infty p_{jlm} x^j y^l z^m\,.
\tag{3.72}
\end{equation}\]</span></p>
<p>As long as <span class="math inline">\(p_{jlm}\)</span> is normalized this function has the property <span class="math inline">\(G(1,1,1) = 1\)</span> and</p>
<p><span class="math display" id="eq:chap3-directed-Gdegreed">\[\begin{equation}
\langle k_d \rangle = \frac{\text{d}G(1,1,1)}{\text{d}x} \equiv G^{(1,0,0)}(1,1,1)\,,
\tag{3.73}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\langle k_d \rangle\)</span> is the average number of incoming links in the network. As for any incoming link there has to be also an outgoing link,</p>
<p><span class="math display" id="eq:chap3-directed-Gdegreedd">\[\begin{equation}
\langle k_d \rangle = \frac{\text{d}G(1,1,1)}{\text{d}y} \equiv G^{(0,1,0)}(1,1,1) = G^{(1,0,0)}(1,1,1)\,.
\tag{3.74}
\end{equation}\]</span></p>
<p>Lastly, for the undirected links</p>
<p><span class="math display" id="eq:chap3-directed-Gdegreeu">\[\begin{equation}
\langle k_u \rangle = \frac{\text{d}G(1,1,1)}{\text{d}z} \equiv G^{(0,0,1)}(1,1,1)\,.
\tag{3.75}
\end{equation}\]</span></p>
<p>A related quantity that will be needed for the derivation is the generating function of the <em>excess degree</em> distribution, which is the degree distribution of nodes reached by following a randomly chosen link, without considering the one we came along. Note that if we choose a node at random, its degree will depend on <span class="math inline">\(p_k\)</span>, however if we follow a link the probability will be higher the more links the node has, <span class="math inline">\(k p_k\)</span>. Thus, the generating function obtained by following a directed link is</p>
<p><span class="math display" id="eq:chap3-directed-Hd">\[\begin{equation}
H_d(x,y,z) = \frac{\sum_{jlm} j x^{j-1} y^l z^m}{\sum_{jkm} j p_{jlm}} = \frac{1}{\langle k_d \rangle} G^{(1,0,0)}(x,y,z)\,,
\tag{3.76}
\end{equation}\]</span></p>
<p>similarly if we follow a directed link in the reverse direction,</p>
<p><span class="math display" id="eq:chap3-directed-Hr">\[\begin{equation}
H_r(x,y,z) = \frac{\sum_{jlm} l x^{j} y^{l-1} z^m}{\sum_{jkm} l p_{jlm}} = \frac{1}{\langle k_d \rangle} G^{(0,1,0)}(x,y,z)\,,
\tag{3.77}
\end{equation}\]</span></p>
<p>and lastly if we follow an undirected link,</p>
<p><span class="math display" id="eq:chap3-directed-Hu">\[\begin{equation}
H_u(x,y,z) = \frac{\sum_{jlm} m x^{j} y^l z^{m-1}}{\sum_{jkm} m p_{jlm}} = \frac{1}{\langle k_u \rangle} G^{(0,0,1)}(x,y,z)\,.
\tag{3.78}
\end{equation}\]</span></p>
<p>The next step is to take into account that the disease will not be transmitted through all the links. Indeed, we define the probability of a link “being infected” in the sense that node <span class="math inline">\(i\)</span> transmits the disease to <span class="math inline">\(j\)</span> using that link as <span class="math inline">\(T\)</span> (regardless of it being directed or undirected). Hence, the probability of a node having exactly <span class="math inline">\(a\)</span> of the <span class="math inline">\(j\)</span> links emerging from it infected is given by the binomial distribution <span class="math inline">\(\binom{j}{a} T^a(1-T)^{j-a}\)</span>. Under these assumptions, the generating function is modified so that</p>
<p><span class="math display" id="eq:chap3-directed-Gt">\[\begin{equation}
\begin{split}
G(x,y,z;T) &amp; = \sum_{jlm} p_{jlm}  \left[ \sum_{a=0}^j \dbinom{j}{a} (Tx)^a (1-T)^{j-a} \sum_{b=0}^l \dbinom{l}{b} (Ty)^b (1-T)^{l-b}\right. \\
	&amp; \left. ~~~~~~~~~~~~~~~\sum_{c=0}^m \dbinom{m}{c} (Tz)^c(1-T)^{m-c}\right] \\
	&amp; = \sum_{jlm} p_{jlm} (1-T+Tx)^j (1-T+Ty)^l (1-T+Tz)^m \\
	&amp; = G(1+(x-1)T,1+(y-1)T,1+(z-1)T)\,.
\end{split}
\tag{3.79}
\end{equation}\]</span></p>
<p>Analogously, the generating functions for the distribution of infected links of a node reached by following randomly chosen links are:</p>
<p><span class="math display" id="eq:chap3-directed-Ht">\[\begin{equation}
\begin{split}
H_f(x,y,z;T) &amp; = H_f(1+(x-1)T,1+(y-1)T,1+(z-1)T) \\
H_r(x,y,z;T) &amp; = H_r(1+(x-1)T,1+(y-1)T,1+(z-1)T) \\
H_u(x,y,z;T) &amp; = H_u(1+(x-1)T,1+(y-1)T,1+(z-1)T)\,.
\end{split}
\tag{3.80}
\end{equation}\]</span></p>
<p>The fundamental quantity that we want to obtain is the number <span class="math inline">\(s\)</span> of nodes contained in an outbreak that begins at a randomly selected node. Let <span class="math inline">\(g(w,T)\)</span> be the generating function for the probability that a randomly chosen node belongs to a group of infected nodes of a given size:</p>
<p><span class="math display" id="eq:chap3-directed-g">\[\begin{equation}
g(w;T) = \sum_s P_s(T) w^s\,.
\tag{3.81}
\end{equation}\]</span></p>
<p>To solve it, we also need to evaluate the probability that a randomly chosen link leads to a node belonging to a group of infected nodes of given size. The generating function of the distribution reads</p>
<p><span class="math display" id="eq:chap3-directed-hd">\[\begin{equation}
h_d(w;T) = \sum_t P_t(T) w^t\,.
\tag{3.82}
\end{equation}\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:chap3-redes-generating"></span>
<img src="images/Fig_chap3_redes_generating.png" alt="Scheme of the generating function approach. Left: The generating function of the excess degree, \(H\), gives the distribution of links (directed and undirected) of a node reached by following a random link. Right: As the infection starts in a node, the generating function of the node’s degree, \(G\), has to be used. Hence, \(G(H(x))\) gives the distribution of links in the first layer, \(G(H(H(x))\) in the second layer, etc." width="674" />
<p class="caption">
Figure 3.10: <strong>Scheme of the generating function approach.</strong> Left: The generating function of the excess degree, <span class="math inline">\(H\)</span>, gives the distribution of links (directed and undirected) of a node reached by following a random link. Right: As the infection starts in a node, the generating function of the node’s degree, <span class="math inline">\(G\)</span>, has to be used. Hence, <span class="math inline">\(G(H(x))\)</span> gives the distribution of links in the first layer, <span class="math inline">\(G(H(H(x))\)</span> in the second layer, etc.
</p>
</div>

<p>This expression satisfies a condition of the form</p>
<p><span class="math display" id="eq:chap3-directed-hd2">\[\begin{equation}
h_d(w;T) = w H_d(1,h_d(w;T),h_u(w;T))\,.
\tag{3.83}
\end{equation}\]</span></p>
<p>Similarly, in the case of undirected links,</p>
<p><span class="math display" id="eq:chap3-directed-hu">\[\begin{equation}
h_u(w;T) = w H_u(1,h_d(w;T),h_u(w;T))\,.
\tag{3.84}
\end{equation}\]</span></p>
<p>With the expressions <a href="chap-chap3.html#eq:chap3-directed-Ht">(3.80)</a> and these two last equations, we have completely defined the distribution of <span class="math inline">\(t\)</span>. It follows (see figure <a href="chap-chap3.html#fig:chap3-redes-generating">3.10</a>) that if the disease starts at a randomly chosen node the distribution is</p>
<p><span class="math display" id="eq:chap3-directed-g2">\[\begin{equation}
g(w;T) = w G(1,h_d(w;T),h_u(w;T))\,,
\tag{3.85}
\end{equation}\]</span></p>
<p>yielding an average size of outbreaks of</p>
<p><span class="math display" id="eq:chap3-directed-s">\[\begin{equation}
\langle s \rangle = \sum_s s P_s(T) = \left.\frac{\text{d}g(w;T)}{\text{d}w} \right|_{w=1}\,.
\tag{3.86}
\end{equation}\]</span></p>
<p>Performing the derivatives and setting <span class="math inline">\(w=1\)</span> we obtain</p>
<p><span class="math display" id="eq:chap3-directed-derivatives">\[\begin{equation}
\begin{split}
g&#39; &amp; = 1 + G^{(0,1,0)} h_d&#39; + G^{(0,0,1)} h_u&#39;\\
h_d&#39; &amp; = 1 + H_d^{(0,1,0)} h_d&#39; + H_d^{(0,0,1)} h_u&#39; \\
h_u&#39; &amp; = 1 + H_u^{(0,1,0)} h_d&#39; + H_u^{(0,0,1)} h_u&#39;\,,
\end{split}
\tag{3.87}
\end{equation}\]</span></p>
<p>where we have dropped the arguments of the functions for readability. Inserting these equations in <a href="chap-chap3.html#eq:chap3-directed-s">(3.86)</a> we obtain</p>
<p><span class="math display" id="eq:chap3-directed-Esd">\[\begin{equation}
\begin{split}
\langle s \rangle  = 1 &amp; + \frac{G^{(0,1,0)} \left(1-H^{(0,1,0)}_d + H_u^{(0,1,0)}\right)}{\left(1-H_d^{(0,1,0)}\right)\left(1-H_u^{(0,0,1)}\right) - H_u^{(0,1,0)}H_d^{(0,0,1)}} \\
	&amp; + \frac{G^{(0,0,1)} \left(1-H^{(0,0,1)}_d + H_u^{(0,0,1)}\right)}{\left(1-H_d^{(0,1,0)}\right)\left(1-H_u^{(0,0,1)}\right) - H_u^{(0,1,0)}H_d^{(0,0,1)}}  \,.
\end{split} 
\tag{3.88}
\end{equation}\]</span></p>
<p>Note that this expression diverges if</p>
<p><span class="math display" id="eq:chap3-directed-diverge">\[\begin{equation}
\left(1-H_d^{(0,1,0)}\right)\left(1-H_u^{(0,0,1)}\right) - H_u^{(0,1,0)}H_d^{(0,0,1)} = 0\,.
\tag{3.89}
\end{equation}\]</span></p>
<p>In other words, equation <a href="chap-chap3.html#eq:chap3-directed-diverge">(3.89)</a> sets the condition for the epidemic threshold. The last step is to note that</p>
<p><span class="math display" id="eq:chap3-directed-HTG">\[\begin{equation}
G^{(1,0,0)} (1,1,1;T) = T G^{(1,0,0)}(1,1,1)\,,
\tag{3.90}
\end{equation}\]</span></p>
<p>and similarly for the rest of equations. Hence, equation <a href="chap-chap3.html#eq:chap3-directed-diverge">(3.89)</a> reads</p>
<p><span class="math display" id="eq:chap3-directed-diverge2">\[\begin{equation}
\left(1-T H_d^{(0,1,0)}\right)\left(1-T H_u^{(0,0,1)}\right) - T^2 H_u^{(0,1,0)}H_d^{(0,0,1)} = 0\,,
\tag{3.91}
\end{equation}\]</span></p>
<p>where now the arguments of the functions are <span class="math inline">\((1,1,1)\)</span> instead of <span class="math inline">\((1,1,1;T)\)</span>.</p>
<p>In the particular case of undirected networks this expression further simplifies to</p>
<p><span class="math display" id="eq:chap3-directed-divergeU">\[\begin{equation}
1 - T H_u^{(0,0,1)} = 0 \Rightarrow T = \frac{1}{H_u^{(0,0,1)}}\,.
\tag{3.92}
\end{equation}\]</span></p>
<p>To rewrite this expression in a more familiar format we can calculate the explicit dependency of <span class="math inline">\(H_u^{(0,0,1)}\)</span> as a function of the network topology:</p>
<p><span class="math display" id="eq:chap3-directed-dH">\[\begin{equation}
\begin{split}
H_u^{(0,0,1)}(1,1,1) &amp; = \frac{1}{\langle k \rangle}\frac{\text{d}}{\text{d}z} G^{(0,0,1)} (1,1,1) =  \frac{1}{\langle k \rangle} \frac{\text{d}^2}{\text{d}z^2} \left.\sum_m p_m z^m \right|_{z=1}\\
	&amp; = \frac{1}{\langle k \rangle} \sum_m m(m-1) p_m = \frac{1}{\langle k \rangle} \left(\langle k^2 \rangle - \langle k \rangle \right) \,.
\end{split}
\tag{3.93}
\end{equation}\]</span></p>
<p>Therefore, the epidemic threshold is</p>
<p><span class="math display" id="eq:chap3-directed-epidemicth">\[\begin{equation}
T = \frac{\langle k \rangle}{\langle k^2 \rangle - \langle k \rangle}\,.
\tag{3.94}
\end{equation}\]</span></p>
</div>
<div id="subsec:chap3-directed-multilayer" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Directionality reduces the epidemic threshold in directed multiplex networks</h3>
<blockquote>
<p>And the “cosmological principles” were, I fear, dogmas that should not have been proposed.<br />
Karl Popper</p>
</blockquote>
<p>As we saw in chapter <a href="chap-chap2.html#chap:chap2">2</a>, network science constitutes a whole field of research on its own. Therefore, any advance in the understanding of networks in general might also have its applications in the study of disease spreading on networks. In particular, we can investigate the dynamics of diseases on the multilayer networks we introduced in section <a href="chap-chap2.html#subsec:chap2-multilayer">2.1.3</a> <span class="citation">[<a href="references.html#ref-Cozzo2013Nov" role="doc-biblioref">246</a>]</span>. One option can be to have the same network pattern in all layers but different dynamics on each of them, such as modeling the spreading of two interacting diseases in the same population <span class="citation">[<a href="references.html#ref-Sanz2014Oct" role="doc-biblioref">247</a>]</span> or the interplay between information and disease spreading that we discussed in the introduction <span class="citation">[<a href="references.html#ref-Granell2013Sep" role="doc-biblioref">248</a>]</span>. On the other hand, we can have the same dynamics in all layers but diverse interaction patterns in each of them, in a similar fashion as our model of section <a href="chap-chap3.html#subsec:chap3-r0-pnas">3.2.3</a>.</p>
<p>In this work we will focus on the latter, i.e., the same dynamics in the whole system but different networks in the layers. Even more, we will consider that the networks can have directed links, something that is usually disregarded in epidemic models (note that adding direction to links implies that more data is necessary than just knowing that there is a relationship between two agents). Some relevant examples of the importance of the directionality in this context are the case of meerkats in which transmission varies between groomers and groomees <span class="citation">[<a href="references.html#ref-Drewe2010Feb" role="doc-biblioref">249</a>]</span> and even in the transmission of HIV that we have briefly discussed, as male-to-female transmission is 2.3 times greater than female-to-male transmission <span class="citation">[<a href="references.html#ref-Nicolosi1994Nov" role="doc-biblioref">117</a>]</span>. Similarly, when addressing the problem of diseases that can be transmitted among different species, it is important to account for the fact that they might be able to spread from one type of host to the other, but not the other way around. For instance, the bubonic plague can be endemic in rodent populations and spread to humans under certain conditions. If it evolves to the pneumonic form, it may then spread from human to human <span class="citation">[<a href="references.html#ref-Kool2005Apr" role="doc-biblioref">250</a>]</span>. Analogously, Andes virus spreads within rodent populations, but it can be transmitted to humans and then spread via person-to-person contacts <span class="citation">[<a href="references.html#ref-Martinez2005Dec" role="doc-biblioref">251</a>]</span>.</p>
<p>Recall that in multilayer networks there are two types of links: intralayer (those contained within layers) and interlayer (those connecting nodes set in different layers). Our objective is to understand how the epidemic threshold is influenced by the directionality of both intralayer and interlayer links. In particular, we will consider multiplex networks composed by two layers with either homogeneous or heterogeneous degree distributions in the layers (i.e., ER or SF networks). Besides, we will analyze several combinations of directionality: (i) Directed layer - Undirected interlinks - Directed layer (DUD); (ii) Directed layer - Directed interlinks - Directed layer (DDD); and Undirected layer - Directed interlinks - Undirected layer (UDU). For the sake of comparison, we will also include the standard scenario, namely, (iv) Undirected layer - Undirected interlinks - Undirected layer (UUU). We will implement a susceptible-infected-susceptible (SIS) model on these networks and study the evolution of the epidemic threshold as a function of the directionality and the coupling strength between layers. In addition, we will derive analytically the epidemic threshold using generating functions (see <a href="chap-chap3.html#subsec:chap3-directed-generating">3.3.2</a>) to obtain theoretical insights on the underlying mechanisms driving the dynamics of these systems.</p>
<p>First, we implement stochastic SIS dynamics on the two layer multiplex networks. Note that as there are two types of links, we can associate a different spreading probability to each of them: the interlayer spreading probability, <span class="math inline">\(\gamma\)</span>, and the intralayer spreading probability, <span class="math inline">\(\beta\)</span> <span class="citation">[<a href="references.html#ref-deArruda2017Feb" role="doc-biblioref">252</a>]</span>. Accordingly, a node can transmit the disease with probability <span class="math inline">\(\beta\)</span> to those susceptible neighbors contained in the same layer and with probability <span class="math inline">\(\gamma\)</span> to those set in the other layer. As a consequence, the epidemic threshold will depend on both parameters. Thus, henceforth we will define the epidemic threshold as <span class="math inline">\(\beta_c\)</span> and explore its value as a function of <span class="math inline">\(\gamma\)</span> (note that previously we defined the epidemic threshold as the ratio <span class="math inline">\(\beta/\mu\)</span>, but in this case we will keep fixed the value of <span class="math inline">\(\mu\)</span> for simplicity).</p>
<p>In the simulations, all the nodes are initially susceptible. The spreading starts when one node is set to the infectious state. Then, at each time step, each infected node spreads the disease through each of its links with probability <span class="math inline">\(\beta\)</span> if the link is contained in a layer and with probability <span class="math inline">\(\gamma\)</span> if the link connects nodes in different layers. Besides, each infected node recovers with probability <span class="math inline">\(\mu\)</span> at each time step. The simulation runs until a stationary state for the number of infected individuals is reached.</p>
<p>To determine the epidemic threshold we fix the value of <span class="math inline">\(\gamma\)</span> and run the simulation over multiple values of <span class="math inline">\(\beta\)</span>, repeating <span class="math inline">\(10^3\)</span> times the simulation for each of those values. The minimum value of <span class="math inline">\(\beta\)</span> at which, on average, the number of infected individuals in the steady state is greater than one determines the value of the epidemic threshold. This procedure is then repeated for several values of <span class="math inline">\(\gamma\)</span> to obtain the dependency of <span class="math inline">\(\beta_c\)</span> with the spreading across layers. Lastly, this dependency is evaluated for <span class="math inline">\(100\)</span> realizations of each network considered in the study and their <span class="math inline">\(\beta_c(\gamma)\)</span> curves are averaged.</p>
<p>For the cases in which the interlinks are directed, we need to add another parameter to the model. If all the links were to point in the same direction, the epidemic threshold would be trivially the one of the source layer and thus the multiplex structure would play no role. For this reason, for each directed link connecting layers <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> we set the directionality to be <span class="math inline">\(u\rightarrow v\)</span> with probability <span class="math inline">\(p\)</span> and <span class="math inline">\(u\leftarrow v\)</span> with probability <span class="math inline">\((1-p)\)</span>. Consequently, in networks with directed interlinks the epidemic threshold will be given as a function of this probability <span class="math inline">\(p\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-redes-simulations"></span>
<img src="images/Fig_chap3_redes_simulations.png" alt="Epidemic threshold in directed multilayer networks according to SIS simulations. Several configurations of networks are considered: A) ER networks with undirected interlinks; B) SF networks with undirected interlinks; C) ER networks with directed interlinks; D) SF networks with directed interlinks. In all cases \(\mu=0.1\) the number of nodes is \(N=2\cdot 10^4\) and for each directionality configuration there are two sets of networks with different average degree as shown in the legend. In the networks with directed interlinks \(p=0.5\)." width="406" />
<p class="caption">
Figure 3.11: <strong>Epidemic threshold in directed multilayer networks according to SIS simulations.</strong> Several configurations of networks are considered: A) ER networks with undirected interlinks; B) SF networks with undirected interlinks; C) ER networks with directed interlinks; D) SF networks with directed interlinks. In all cases <span class="math inline">\(\mu=0.1\)</span> the number of nodes is <span class="math inline">\(N=2\cdot 10^4\)</span> and for each directionality configuration there are two sets of networks with different average degree as shown in the legend. In the networks with directed interlinks <span class="math inline">\(p=0.5\)</span>.
</p>
</div>

<p>The results, figure <a href="chap-chap3.html#fig:chap3-redes-simulations">3.11</a>, signal that the consequences of changing the directionality of some links is completely different for SF and ER networks. In particular, in <a href="chap-chap3.html#fig:chap3-redes-simulations">3.11</a>A, we can see that for networks with <span class="math inline">\(\langle k \rangle = 6\)</span> the epidemic threshold is very similar in both UUU and DUD configurations. This effect is again seen for denser networks, <span class="math inline">\(\langle k \rangle = 12\)</span>, implying that it is the directionality of the interlinks, and not the one of the links contained within layers, the main driver of the epidemic in these networks. On the other hand, in figure <a href="chap-chap3.html#fig:chap3-redes-simulations">3.11</a>B we can see that this behavior is not replicated in SF networks. Certainly, there is a large difference between the curves of the UUU and DUD configurations, implying that the directionality of intralinks is much more important in this type of networks. A similar pattern is observed in figures <a href="chap-chap3.html#fig:chap3-redes-simulations">3.11</a>C and <a href="chap-chap3.html#fig:chap3-redes-simulations">3.11</a>D, in which the interlinks are directed. Moreover, in all the cases considered the epidemic threshold is always lower for those configurations with undirected links within the layers, compared to those in which those links are directed, given the same interlink directionality.</p>
<p>To get further insights into the mechanisms driving this behavior we proceed to compute analytically the epidemic threshold. We introduced the generating function of the network, equation <a href="chap-chap3.html#eq:chap3-directed-G">(3.72)</a>, saying that it accounts for the probability of having <span class="math inline">\(j\)</span> incoming links, <span class="math inline">\(l\)</span> outgoing links and <span class="math inline">\(m\)</span> undirected links. However, in this case the directionality of links within the layers is always the same (we do not mix directed and undirected links). Hence, we can use <span class="math inline">\(j\)</span> as an indicator for directed links when we have directed intralinks, or we can regard it as the number of undirected links otherwise. This frees <span class="math inline">\(m\)</span> to be used for the interlinks. In other words, the generating function will now be <span class="math inline">\(G(x,z)\)</span> if the network has the shape UXU and <span class="math inline">\(G(x,y,z)\)</span> if it is DXD, with <span class="math inline">\(z\)</span> representing the links connecting different layers.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-redes-h"></span>
<img src="images/Fig_chap3_redes_h.png" alt="Scheme of the generating function on multilayer networks. Recursive relation of generating functions for the size distribution of outbreaks by following a link in layer 1, \(h_1\), from 1 to 2, \(h_{12}\), in layer 2, \(h_2\), and from 2 to 1, \(h_{21}\)." width="528" />
<p class="caption">
Figure 3.12: <strong>Scheme of the generating function on multilayer networks.</strong> Recursive relation of generating functions for the size distribution of outbreaks by following a link in layer 1, <span class="math inline">\(h_1\)</span>, from 1 to 2, <span class="math inline">\(h_{12}\)</span>, in layer 2, <span class="math inline">\(h_2\)</span>, and from 2 to 1, <span class="math inline">\(h_{21}\)</span>.
</p>
</div>

<p>Analogously, the definition of the generating function for the excess distribution <a href="chap-chap3.html#eq:chap3-directed-Hd">(3.76)</a> does not change. The first difference is encountered when we want to obtain the probability of a link being infected. In the previous case, we set said probability equal to <span class="math inline">\(T\)</span> in all links, but now we have <span class="math inline">\(\beta\)</span> for links within layers and <span class="math inline">\(\gamma\)</span> for links across layers. Thus, we keep <span class="math inline">\(T\)</span> as the probability of a link within layers being infected, and denote the probability of the other set of links being infected as <span class="math inline">\(T_{uv}\)</span>. With these definitions equation <a href="chap-chap3.html#eq:chap3-directed-Gt">(3.79)</a> now reads</p>
<p><span class="math display" id="eq:chap3-redes-GTuv">\[\begin{equation}
G(x,y,z;T,T_{uv}) = G(1+(x-1)T,1+(y-1)T,1+(z-1)T_{uv})\,.
\tag{3.95}
\end{equation}\]</span></p>
<p>Next, we introduced the generating function used to calculate the probability that a randomly chosen link belongs to the group of infected nodes. We distinguished <span class="math inline">\(h_d\)</span> and <span class="math inline">\(h_u\)</span> if the links were directed or undirected respectively. In this case, as the directionality is the same, what we need to define is <span class="math inline">\(h_1\)</span> if the link is in layer <span class="math inline">\(1\)</span>, <span class="math inline">\(h_2\)</span> if it is in layer 2, <span class="math inline">\(h_{12}\)</span> if it is a link going from layer 1 to layer 2 and <span class="math inline">\(h_{21}\)</span> if it is going from layer 2 to layer 1. The recursive relations in this case (see figure <a href="chap-chap3.html#fig:chap3-redes-h">3.12</a>) read</p>
<p><span class="math display" id="eq:chap3-redes-hrec">\[\begin{equation}
\begin{split}
h_1(w;T,T_{uv}) &amp; = wH_1(1,h_1(w;T,T_{uv}),h_{12}(w;T,T_{uv});T,T_{uv}) \\
h_2(w;T,T_{uv}) &amp; = wH_2(1,h_2(w;T,T_{uv}),h_{21}(w;T,T_{uv});T,T_{uv}) \\
h_{12}(w;T,T_{uv}) &amp; = wH_{12}(1,h_2(w;T,T_{uv}),h_{21}(w;T,T_{uv});T,T_{uv}) \\
h_{21}(w;T,T_{uv}) &amp; = wH_{21}(1,h_1(w;T,T_{uv}),h_{12}(w;T,T_{uv});T,T_{uv}) \,.
\end{split}
\tag{3.96}
\end{equation}\]</span></p>
<p>Then, the generating function for the distribution of the size of an outbreak starting in a randomly chosen node in layer 1 is</p>
<p><span class="math display" id="eq:chap3-redes-g">\[\begin{equation}
g(w;T,T_{uv}) = wG(1,h_1(w;T,T_{uv}),h_{12}(w;T,T_{uv});T,T_{uv})\,.
\tag{3.97}
\end{equation}\]</span></p>
<p>Leading to the expression of the average size of an outbreak:</p>
<p><span class="math display" id="eq:chap3-redes-sg">\[\begin{equation}
\begin{split}
\langle s \rangle &amp; = \sum_s s P_s(T) = \left.\frac{\text{d}g(w;T,T_{uv})}{\text{d}w}\right|_{w=1} \\
	&amp; = 1 + G^{(0,1,0)}h_1&#39; + G^{(0,0,1)}h_{12}&#39;\,.
\end{split}
\tag{3.98}
\end{equation}\]</span></p>
<p>As in the previous case, this equation diverges when the denominator is equal to 0. Hence, after some algebra, the condition that establishes the epidemic threshold reads</p>
<p><span class="math display" id="eq:chap3-redes-denominator">\[\begin{equation}
\begin{split}
0  = &amp; \left[\left(1-H_1^{(0,1,0)}\right) \left(1-H_{12}^{(0,0,1)}H_{21}^{(0,0,1)}\right)-H_1^{(0,0,1)}H_{12}^{(0,0,1)}H_{21}^{(0,1,0)}\right] \\
&amp; \cdot \left[\left(1-H_2^{(0,1,0)}\right)\left(1-H_{12}^{(0,0,1)}H_{21}^{(0,0,1)}\right) - H_2^{(0,0,1)}H_{21}^{(0,0,1)}H_{12}^{(0,1,0)}\right] \\
&amp; - H_1^{(0,0,1)}H_2^{(0,0,1)} H_{12}^{(0,1,0)} H_{21}^{(0,1,0)}\,.
\end{split}
\tag{3.99}
\end{equation}\]</span></p>
<p>Note that this expression works for all the configurations we are considering in this work, given that we choose the proper values of <span class="math inline">\(H_x\)</span>. For instance, for the DUD configuration we have</p>
<p><span class="math display" id="eq:chap3-redes-hdud">\[\begin{equation}
\begin{split}
&amp; H_1^{(0,1,0)} = H_2^{(0,1,0)} = T\langle k \rangle \\
&amp; H_1^{(0,0,1)} = H_2^{(0,0,1)} = T \langle k \rangle \\
&amp; H_{12}^{(0,1,0)} = H_{21}^{(0,1,0)} = T_{uv} \\
&amp; H_{12}^{(0,0,1)} = H_{21}^{(0,0,1)} = T_{uv}\,
\end{split}
\tag{3.100}
\end{equation}\]</span></p>
<p>yielding</p>
<p><span class="math display">\[\begin{equation}
\tag{ER-DUD}
T_c = \frac{1-T_{uv}}{\langle k \rangle}\,.
\end{equation}\]</span></p>
<p>Similarly, we can obtain the epidemic threshold for the rest of the configurations:</p>
<p><span class="math display">\[\begin{equation}
\tag{ER-UUU}
T_c = \frac{1-T_{uv}}{\langle k \rangle + 1 - T_{uv}}\,,
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\tag{ER-DDD}
T_c = \frac{2}{\langle k \rangle ( 2 + m + \sqrt{m(m+8)})}\,,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(m = p(1-p) T_{uv}^2\)</span>,</p>
<p><span class="math display">\[\begin{equation}
\tag{ER-UDU}
T_c = \frac{2(1+\langle k \rangle ) + m&#39; - \sqrt{m&#39;(4+8\langle k \rangle +m&#39;)}}{2((1+\langle k \rangle)^2 -m&#39; \langle k \rangle)}\,,
\end{equation}\]</span></p>
<p>with <span class="math inline">\(m&#39;=\langle k \rangle p (1-p) T_{uv}^2\)</span>. These results were simplified thanks to the property <span class="math inline">\(\langle k^2\rangle = \langle k \rangle^2 + \langle k \rangle\)</span> of Poisson distributions. For the case of SF, on the other hand, we cannot do this simplification and thus some expressions will depend on both moments of the distribution:</p>
<p><span class="math display">\[\begin{equation}
\tag{DUD-SF}
T_c = \frac{1-T_{uv}}{\langle k \rangle}\,,
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\tag{UUU-SF}
T_c = \frac{\langle k \rangle (1-T_{uv})}{\langle k^2\rangle (1-T_{uv}) + \langle k \rangle^2 T_{uv}}\,,
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\tag{DDD-SF}
T_c = \frac{2}{\langle k \rangle (2+m+\sqrt{m(m+8)})}\,,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(m = p(1-p) T_{uv}^2\)</span>, and lastly</p>
<p><span class="math display">\[\begin{equation}
\tag{UDU-SF}
T_c = \frac{2\langle k^2\rangle \langle k \rangle + \langle k \rangle^2\left(\langle k \rangle m - \sqrt{m(4\langle k^2\rangle + \langle k \rangle^2(4+m))}\right)}{2(\langle k ^2\rangle^2 - \langle k \rangle^4m)}\,.
\end{equation}\]</span></p>
<p>These expressions closely match the results obtained in the simulations, figure <a href="chap-chap3.html#fig:chap3-redes-simTeo">3.13</a>. Again, we can observe that the value of the epidemic threshold of the DUD configuration in SF networks tends to the value of the UUU configuration for large values of the spreading probability across layers, mimicking the behavior of ER networks. Hence, in general, we can conclude that the directionality (or lack of) of the interlinks is the main driver of the epidemic spreading process. The exception is the limit of small spreading from layer to layer as in this scenario the directionality of interlinks makes SF networks much more resilient. Altogether, the conclusion is that directionality reduces the impact of disease spreading in multilayer systems.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-redes-simTeo"></span>
<img src="images/Fig_chap3_redes_simTeo.png" alt="Epidemic threshold in directed multilayer networks, simulations vs. theory. A) Comparison between the results of the stochastic simulations (points) and the theoretical predictions (lines) for the ER set of networks. B) As A) but for SF networks." width="676" />
<p class="caption">
Figure 3.13: <strong>Epidemic threshold in directed multilayer networks, simulations vs. theory.</strong> A) Comparison between the results of the stochastic simulations (points) and the theoretical predictions (lines) for the ER set of networks. B) As A) but for SF networks.
</p>
</div>

<p>It is worth point out that these results are not only relevant for the situations we have described in this chapter so far. One particularly interesting and open challenge is to quantify the effects that the interplay between different social networks could have on spreading dynamics. The theoretical framework developed here is particularly suited to study this and similar challenges related to the spreading of information in social networks. On one hand, because social links are not always reciprocal <span class="citation">[<a href="references.html#ref-Mercken2010Jan" role="doc-biblioref">253</a>]</span>, specially in online systems in which a user is not necessarily followed by her followings. Besides, disease-like models have been widely used to study information dissemination <span class="citation">[<a href="references.html#ref-Cozzo2013Nov" role="doc-biblioref">246</a>], [<a href="references.html#ref-Weng2013" role="doc-biblioref">254</a>]</span>. For this reason, we have analyzed the dependence of the epidemic threshold with the inter-spreading rate in a real social network composed by two layers, figure <a href="chap-chap3.html#fig:chap3-redes-social">3.14</a>A. The first layer of the multilayer system is made up by the directed set of interactions in a subset of users of the now defunct FriendFeed platform, whereas the second layer is defined by the directed set of interactions of those same users in Twitter. Even though this multiplex network corresponds to a DUD configuration, we have also explored the other configurations that we have studied. Note that in contrast to the synthetic networks used so far, in this network the layers have different average degree. In particular, the FriendFeed layer has 4,768 nodes and 29,501 directed links, resulting in an average out-degree of 6.19 while the Twitter layer is composed by 4,786 nodes and 40,168 directed links, with an average out-degree of 8.42. Nevertheless, their degree distributions are both heavy tailed, resembling the power law structure of SF networks, although the maximum degree in the FriendFeed network is much larger than in the Twitter network <span class="citation">[<a href="references.html#ref-magnani2011" role="doc-biblioref">255</a>]</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-redes-social"></span>
<img src="images/Fig_chap3_redes_social.png" alt="Epidemic threshold in a multilayer social system. Epidemic threshold obtained from simulations in a multiplex network composed by users of two different social platforms: FriendFeed and Twitter. The original network, panel A, has directed intralinks and undirected interlinks, corresponding to a DUD configuration. Nevertheless, to explore the effects of directionality in a real scenario, the four discussed configurations are considered in panel B. For those configurations with directed interlinks we set \(p=0.5\)." width="677" />
<p class="caption">
Figure 3.14: <strong>Epidemic threshold in a multilayer social system.</strong> Epidemic threshold obtained from simulations in a multiplex network composed by users of two different social platforms: FriendFeed and Twitter. The original network, panel A, has directed intralinks and undirected interlinks, corresponding to a DUD configuration. Nevertheless, to explore the effects of directionality in a real scenario, the four discussed configurations are considered in panel B. For those configurations with directed interlinks we set <span class="math inline">\(p=0.5\)</span>.
</p>
</div>

<p>The results, figure <a href="chap-chap3.html#fig:chap3-redes-social">3.14</a>B, confirm the findings of synthetic networks. In particular, configurations with some directionality are always more resilient against the spreading. Consequently, information travels much more easily in undirected systems than in directed systems. This is particularly worrisome given that even though Twitter can be modeled as a directed network, social networks such as Facebook and Whatsapp should be modeled using undirected configurations and, recently, these two platforms were identified as one of the main sources of misinformation spreading <span class="citation">[<a href="references.html#ref-Machado2019" role="doc-biblioref">256</a>]</span>.</p>
<p>In summary, we have seen the importance that networks have in shaping disease dynamics. Hence, as more data becomes available, our network models should be improved in order to better account for the real mechanisms behind such a dynamics. To this end, in this section we have developed a framework that allows studying disease-like processes in multilayer networks with, possibly, directed links. This represents an important step towards the characterization of diffusion processes in interdependent systems. Our results show that directionality has a positive impact on the system’s resistance to disease propagation. Furthermore, we have seen that the way in which interconnected social networks are coupled can determine their ability to spread information. Hence, the insights obtained in this work can be applied to a plethora of systems and show that more emphasis should be put in studying the role of interlinks and directionality in diffusion processes.</p>
</div>
</div>
<div id="sec:chap3-age" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Age and network structures</h2>
<p>The problems that we have studied in this chapter have shown us that, when we consider no longer that humans are particles, the dynamics of an epidemic can change dramatically. Note that the mass action approximation was just a handy tool to overcome either the scarcity of data in the past or the analytical intractability of some formulations. However, nowadays we have both enough data and computational power to introduce many more details in the dynamics.</p>
<p>It is now time to return to where we left at the end of chapter <a href="chap-chap2.html#chap:chap2">2</a>. In section <a href="chap-chap2.html#subsec:chap2-generatingAge">2.6.3</a> we introduced a mathematical framework that allowed us to create networks in which both the degree distribution and the age contact patterns of the population could be taken into account. With all the information we have gathered about disease dynamics, we can finally analyze the implications of this choice.</p>
<p>In the following, we will consider four different scenarios depending on the data that one may have at her disposal:</p>
<ol style="list-style-type: decimal">
<li>Homogeneous mixing with <span class="math inline">\(\langle C \rangle\)</span>: suppose that the only data available is the average number of contacts and individual may have. In this case, we would be in the same situation as in the studies of gonorrhea that we presented in section <a href="chap-chap3.html#sec:chap3-directed">3.3</a>. According to equation <a href="chap-chap3.html#eq:chap3-directed-th1">(3.53)</a> the epidemic threshold in this situation is</li>
</ol>
<p><span class="math display">\[\begin{equation}
\frac{\beta}{\mu} = \frac{1}{\langle C \rangle}\,.
\end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Homogeneous mixing with age contact patterns: if data about the mixing patterns of the population is available, we can improve the model by creating multiple homogeneous mixing groups, one for each age bracket, as we discussed in section <a href="chap-chap3.html#subsec:chap3-homo-age">3.1.1</a>. Note that this formulation is similar to the one that Anderson and May introduced for studying interacting groups with different activity patterns, equation <a href="chap-chap3.html#eq:chap3-directed-maySIR">(3.54)</a>. Hence, the epidemic threshold, according to equation <a href="chap-chap3.html#eq:chap3-directed-th2">(3.57)</a>, should be</li>
</ol>
<p><span class="math display">\[\begin{equation}
\frac{\beta}{\mu} = \frac{\langle C \rangle}{\langle C^2 \rangle}\,.
\end{equation}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Network information: if we have only information about the network structure, the epidemic threshold is given by <a href="chap-chap3.html#eq:chap3-directed-thSIR">(3.71)</a>,</li>
</ol>
<p><span class="math display">\[\begin{equation}
\frac{\beta}{\mu} = \frac{\langle k \rangle}{\langle k^2\rangle - \langle k \rangle}\,.
\end{equation}\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Network and age information: if we are able to obtain information about both the network structure and the age mixing patterns of the population, we can build the network of interactions using the techniques introduced in section <a href="chap-chap2.html#subsec:chap2-generatingAge">2.6.3</a>.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:chap3-age-comparison"></span>
<img src="images/Fig_chap3_age_comparison.png" alt="Phase diagram for different amounts of data. We compare the total number of recovered individuals as a function of the ratio \(\beta/\mu\) for four models, each one determined by the amount of data used. In the homogeneous scenario the only information is \(\langle C\rangle = 6.18\) which yields an epidemic threshold of approximately \(0.16\). Next, we extract the information about the age mixing patterns of Belgium in 2005 from the polymod study [131] and weight the matrix so that the average number of contacts is also \(6.18\). This, in turn, produces \(\langle C^2\rangle = 40.37\) yielding an epidemic threshold slightly over \(0.15\). To model the network structure we have assumed that the degree distribution follows a power law with \(\langle k \rangle = 6.18\) and \(\langle k^2\rangle = 102.27\), resulting in a threshold of \(0.06\). Lastly, we have combined this network distribution with the data from Belgium to build the age contact network." width="432" />
<p class="caption">
Figure 3.15: <strong>Phase diagram for different amounts of data.</strong> We compare the total number of recovered individuals as a function of the ratio <span class="math inline">\(\beta/\mu\)</span> for four models, each one determined by the amount of data used. In the homogeneous scenario the only information is <span class="math inline">\(\langle C\rangle = 6.18\)</span> which yields an epidemic threshold of approximately <span class="math inline">\(0.16\)</span>. Next, we extract the information about the age mixing patterns of Belgium in 2005 from the polymod study <span class="citation">[<a href="references.html#ref-Mossong2008Mar" role="doc-biblioref">131</a>]</span> and weight the matrix so that the average number of contacts is also <span class="math inline">\(6.18\)</span>. This, in turn, produces <span class="math inline">\(\langle C^2\rangle = 40.37\)</span> yielding an epidemic threshold slightly over <span class="math inline">\(0.15\)</span>. To model the network structure we have assumed that the degree distribution follows a power law with <span class="math inline">\(\langle k \rangle = 6.18\)</span> and <span class="math inline">\(\langle k^2\rangle = 102.27\)</span>, resulting in a threshold of <span class="math inline">\(0.06\)</span>. Lastly, we have combined this network distribution with the data from Belgium to build the age contact network.
</p>
</div>

<p>To properly compare the four situations we will set in all of them the same average number of contacts, which we denote by <span class="math inline">\(\langle C\rangle\)</span> when there is no network information and by <span class="math inline">\(\langle k \rangle\)</span> when there is. Next, we perform numerical simulations of these scenarios, using the SIR model introduced so far (with the adequate modifications depending on the amount of data available), to compare the evolution of the epidemic size as a function of the ratio <span class="math inline">\(\beta/\mu\)</span>, figure (fig:chap3-age-comparison).</p>
<p>We can clearly see the effect that the heterogeneity of the network introduces in the system. For the homogeneous scenario and the homogeneous with information about the mixing patterns, the epidemic threshold is almost the same. However, when we introduce a network with a power law degree distribution, the heterogeneity in the contacts is much larger, yielding a smaller epidemic threshold. Thus, it seems that from this point of view it is more important to be able to collect data about the contact structure of the population than from the age mixing patterns.</p>
<div class="figure" style="text-align: center"><span id="fig:chap3-age-diff"></span>
<img src="images/Fig_chap3_age_diff.png" alt="Comparison of attack rate per age group. In A we compare the number of recovered individuals in each age bracket in the model with age and network structure against the model with information of the network structure, so that positive values imply that the attack was larger in the model with more information, and vice versa. In B the comparison is done between the model with all the information and the homogeneous with age mixing patterns. Note that to compare similar situations a value of \(\beta=0.21\) has been chosen, as it is the value in which the three dynamics intersect in figure 3.15." width="442" />
<p class="caption">
Figure 3.16: <strong>Comparison of attack rate per age group.</strong> In A we compare the number of recovered individuals in each age bracket in the model with age and network structure against the model with information of the network structure, so that positive values imply that the attack was larger in the model with more information, and vice versa. In B the comparison is done between the model with all the information and the homogeneous with age mixing patterns. Note that to compare similar situations a value of <span class="math inline">\(\beta=0.21\)</span> has been chosen, as it is the value in which the three dynamics intersect in figure <a href="chap-chap3.html#fig:chap3-age-comparison">3.15</a>.
</p>
</div>

<p>On the other hand, note that there are many diseases which can affect differently an individual depending on her age. This effect was particularly important, for instance, in the 2009 H1N1 pandemic <span class="citation">[<a href="references.html#ref-Liu2018Dec" role="doc-biblioref">257</a>]</span>. Furthermore, age is one of the factors used to classify people into risk groups, which in turn are the main targets of vaccination campaigns. Hence, even if, according to figure <a href="chap-chap3.html#fig:chap3-age-comparison">3.15</a>, knowledge of the age structure does not seem too important, once we look closer into the dynamics of the system the situation changes.</p>
<p>To illustrate this, in figure <a href="chap-chap3.html#fig:chap3-age-diff">3.16</a>, we compare the attack rate of each group in the different models. In particular, in panel A we show the relative change on the amount of recovered individuals per age group between the model with all the information and the model that only considers the network structure. As we can see, the complete model has higher attack rates in teenagers, while having much lower attack rates among the elderly. Thus, even if the total attack rate in both situations is the same, if the decision to administer a vaccine is only based on the network structure we would be making a big mistake.</p>
<p>Conversely, adding the network information to the age mixing matrices has a smaller effect, indicating that from this point of view it is more important to collect data about the age mixing patterns of the population than from the network structure. Note that the network structure in these models is not extracted from data. Hence, the differences that we can see in panel B do not have any specific interpretation rather than that the power law distribution that we chose is responsible for those differences.</p>
<p>To summarize, it is clear that the more data we have, the better, as long as we use it properly and fully understand it. Yet, if for some reason we need to choose which data we need to collect, it is important to know the final application, as it is not straightforward to say which information is more valuable. In particular, we have seen that the network structure has dramatic effects on both the epidemic threshold and the incidence of the epidemic. But, on the other hand, having information about the mixing patterns of the population might be more valuable in some situations, such as determining risk groups for vaccination.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p>A noteworthy exception is the work by Daniel Bernoulli in 1766, although he was just too ahead of his time. Furthermore, some authors claim that the credit for creating the first modern disease transmission model should go to Pyotr Dimitrievich Enko. Unfortunately, even though he published his work as early as 1889, he wrote it in russian and thus it became largely unnoticed for the majority of the scientific community until it was translated by the middle of the XX century (see <span class="citation">[<a href="references.html#ref-Foppa2016Oct" role="doc-biblioref">140</a>], [<a href="references.html#ref-Dietz1988May" role="doc-biblioref">141</a>]</span> for a nice introduction to the early days of mathematical epidemiology).<a href="chap-chap3.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>A metapopulation is a set of populations that are spatially separated but can exchange individuals. Within each subpopulation any plausible disease dynamics can be implemented, although usually the homogeneous mixing approach is used <span class="citation">[<a href="references.html#ref-Aleta2017Ma" role="doc-biblioref">172</a>]</span>.<a href="chap-chap3.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>In the original paper at a certain point the authors expand a quantity using Taylor’s theorem an introduce the notation <span class="math inline">\(R_n = \int_0^\infty a^n p(a) m(a) \text{d}A\)</span>. Then, they determine the ratio between the total births in two successive generations to be <span class="math inline">\(\int_0^\infty p(a) m(a) \text{d} A\)</span>, which is equal to <span class="math inline">\(R_0\)</span> according to the previous definition. Thus, the subscript <span class="math inline">\(0\)</span> historically would represent the <span class="math inline">\(0\)</span>-<span class="math inline">\(th\)</span> moment of the distribution. In modern literature, however, the subscript is interpreted as referring to the “very beginning” of the epidemic <span class="citation">[<a href="references.html#ref-Foppa2016Oct" role="doc-biblioref">140</a>]</span>. Note also that <span class="math inline">\(R_0\)</span> is usually pronounced <em>R naught</em> in Britain and <em>R zero</em> in the U.S. <span class="citation">[<a href="references.html#ref-Halloran1993" role="doc-biblioref">187</a>]</span>.<a href="chap-chap3.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>Although the notation <span class="math inline">\(R_0\)</span> is well established, there is not an agreement on how to call this quantity. Exchanging the word reproduction for <em>reproductive</em> is common in the literature, as well as using <em>rate</em> or <em>ratio</em> instead of number. Although the differences are minimal, note that <em>rate</em> is clearly wrong as it is not a rate but a (dimensionless) ratio <span class="citation">[<a href="references.html#ref-Heesterbeek1996Mar" role="doc-biblioref">191</a>]</span>.<a href="chap-chap3.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>Even though we have not discussed yet on how to introduce networks in epidemic modeling, note that an homogeneous population is equivalent to a complete network in which every node is connected to every other node. Hence, these overlapping structures can also be regarded as a multiplex network in which each node can be in more than one layer<a href="chap-chap3.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>Actually, the shape of the distribution was the same as the ones we saw in figure <a href="chap-chap2.html#fig:chap2-generatingData">2.10</a> when we studied age contact patterns. The high heterogeneity of human interactions is clearly not restricted to sexual activity.<a href="chap-chap3.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>Despite the great leap forward that his proposal represented, one could argue that he might have been a bit naive when he concluded the paper saying: <em>“All this having been said, I am sanguine. God is still in his heaven. The environment is generally benign. The community is resilient. Most individuals are acceptably polite, orderly and well behaved. On the list of vulnerabilities in our complex society, this one is distinguished primarily by its novelty. Unlike some of the more intractable ones, this one will yield to good will. In the face of genuine evil intent, I prefer it to plastic explosives in power plants.”</em><a href="chap-chap3.html#fnref14" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-chap2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-chap4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["/assets/docs/Aleta_Thesis.pdf"],
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
